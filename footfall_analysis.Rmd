# What's this?
- Footfall distribution analysis
- Long-term time series analysis for footfall distributions from January to April
- Summary descriptive statistics for weekly footfall distributions
- Short-term time series analysis for daily footfall distributions
- Spatial autocorrelation of footfall distributions (Local Moran's I)

# Install all required packages

```{r}
#install.packages("r5r")
#install.packages("data.table")
#install.packages("tidytransit")
#install.packages("osmextract")
#install.packages("osmdata")
#install.packages("remote")
```

# Load all required packages for data cleaning

```{r}
library(sf)
library(sp)
library(ggplot2)
library(here)
library(tidyverse)
library(dplyr)
library(janitor)
library(plotly)
library(tmap)
library(spdep)
library(tmaptools)
library(spatstat)
library(fpc)
library(RColorBrewer)
library(shinyjs)
```

Some useful links: *Andy lecture on R: <https://andrewmaclachlan.github.io/CASA0005repo/introduction-to-r.html>*

# Data loading

```{r}
# To print working directory and use the "here" function to import data from the current working directory
here::here()
# To import footfall csv from local file and name it as footfall
footfall <- read.csv(here::here("CDRC", "UWB_footfall_2019-08-23-2022-10-12_by_hour.csv"), header = TRUE, sep = ",", encoding = "latin1")
location <- read.csv(here::here("CDRC", "UWB_Metadata_ONLINE.csv"), header = TRUE, sep = ",", encoding = "latin1", na = " ")
boroughs <- st_read(here::here("statistical-gis-boundaries-london", "ESRI", "London_Borough_Excluding_MHW.shp"))
wards <- st_read(here::here("statistical-gis-boundaries-london", "ESRI", "London_Ward.shp"))
lsoas <- st_read(here::here("statistical-gis-boundaries-london", "ESRI", "LSOA_2011_London_gen_MHW.shp"))
```

# Examining dataset

```{r}
class(footfall)
# To check the data type in footfall dataset
datatypelist_ff <- footfall %>%
  summarise_all(class) %>%
  pivot_longer(everything(),
               names_to = "All_variables",
               values_to = "Variable_class")
datatypelist_ff

class(location)
# To check the data type in location dataset
datatypelist_location <- location %>%
  summarise_all(class) %>%
  pivot_longer(everything(),
               names_to = "All_variables",
               values_to = "Variable_class")
datatypelist_location
```

# Data wrangling

```{r}
# Clean the data first, to ensure both datasets have a shared column name for joining
location <- location %>%
  dplyr::rename(instsigid = "InstSigID") %>%
  clean_names()

london_location <- location %>%
  filter(county == "Greater London")

# We have to join both datasets together to get the location of our footfall
joined_ff <- location %>%
  left_join(.,
            footfall, 
            by = c("instsigid" = "instsigid")) %>%
  clean_names()

# Only selecting retail areas within London from the lists, using the county = Greater London
london_ff <- joined_ff %>%
  filter(county == "Greater London")
london_ff <- london_ff %>%
  dplyr::select("instsigid", "date", "hour", "footfall_sum", "footfall_mean", "street", "county", "latitude", "longitude")

# Renaming the column
london_ff <- london_ff %>%
  dplyr::rename(Time = 'hour') %>%
  clean_names()


# Only selecting certain timeframe for the research, testing, and setting the day of the week/ day of the month from date
london_ff$date <- as.Date(london_ff$date, format="%Y-%m-%d")
london_ff$weekday <- weekdays(london_ff$date)
london_ff

london_ff <- london_ff %>%
  mutate(month = lubridate::month(london_ff$date))
london_ff <- london_ff %>%
  mutate(month = month.abb[as.numeric(month)])

# Selecting ff data only in 2022 Jan to April
ff_2022 <- london_ff %>%
  filter(date >= as.Date("2022-01-01") & date <= as.Date("2022-04-30"))
```

# Saving output for r5r analysis

```{r}
write.csv(london_ff, "london_ff.csv")
write.csv(ff_2022, "london_ff_2022JanApr")
write.csv(london_location, "ff_location.csv")
```

# Spatial distributtion of the footfall location 

```{r}
# Projecting the points on the same geographical projection
ff_point <- london_location %>%
  st_as_sf(., coords = c("longitude", "latitude"),
           crs = 4326)
boroughs <- boroughs %>%
  st_transform(., 4326)
boroughs <- boroughs %>%
  st_transform(., 27700)
wards <- wards %>%
  st_transform(., 4326)
lsoas <- lsoas %>%
  st_transform(., 4326)

tmap_mode("plot")
library(tmap)

landuse_compare <- ff_point %>%
  filter(street == "Edgware Road North" & street == "Daneland Walk")


ff_location_map <- tm_shape(boroughs) +
  tm_polygons(col = "white", alpha = 0.1) +
  tm_text("NAME", size = 0.3, col = "black", fontface = 2) +
tm_shape(location_proj) +
  tm_dots(col = "blue") +
  tm_layout(title = "Spatial Distribution of Retail Locations", title.position = c('center', 'top'), title.size = 2, inner.margins = c(0.1, 0.1, 0.1, 0.1), legend.position = c('right')) +
  tm_compass(position = c('right', 'top'))
ff_location_map
# tm_save(ff_location_map, filename = "retail location.png", plot = p, width = 5, height = 4, dpi = 300)
```

```{r}
while (dev.cur() > 1) {
  dev.off()
}
```

# Subsetting footfall data, 2022 Jan to Apr with 13 locations

```{r}
bruce_grove_south <- ff_2022 %>%
  filter(street == "Bruce Grove South") %>%
  clean_names()

clapham_high_street_middle <- ff_2022 %>%
  filter(street == "Clapham High Street Middle") %>%
  clean_names()

clapham_road_middle <- ff_2022 %>%
  filter(street == "Clapham Road Middle") %>%
  clean_names()

daneland_walk <- ff_2022 %>%
  filter(street == "Daneland Walk") %>%
  clean_names()

#100027, 2911 obs
edgware_road_north_100027 <- ff_2022 %>%
  filter(instsigid == "100027") %>%
  clean_names()

#100092, 2738 obs
edgware_road_south_100092 <- ff_2022 %>%
  filter(instsigid == "100092") %>%
  clean_names()

high_road_middle <- ff_2022 %>%
  filter(street == "High Road Middle") %>%
  clean_names()

kennington_road_middle <- ff_2022 %>%
  filter(street == "Kennington Road Middle") %>%
  clean_names()

norwood_road_south <- ff_2022 %>%
  filter(street == "Norwood Road South")  %>%
  clean_names()

oxford_street_west <- ff_2022 %>%
  filter(street == "Oxford Street West") %>%
  clean_names()

streatham_high_road_middle <- ff_2022 %>%
  filter(street == "Streatham High Road Middle") %>%
  clean_names()

# 2905 obs
the_braodway <- ff_2022 %>%
  filter(instsigid == "100081") %>%
  clean_names()

wandsworth_road_south <- ff_2022 %>%
  filter(street == "Wandsworth Road South") %>%
  clean_names()
```

```{r}
# normalising data 
```

# Weekly footfall distribution -- Boxplot

## Wholeday (24 hours)

### Whole week (Monday to Sunday)

```{r}
# Bruce Grove South
bgs_boxplot_whole_week <- bruce_grove_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
)

ggplot(data = bgs_boxplot_whole_week, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Bruce Grove South (all hours)")
```

```{r}
# Clapham High Street Middle
chsm_boxplot_whole_week <- clapham_high_street_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
)

ggplot(data = chsm_boxplot_whole_week, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Clapham High Street Middle (all hours)")
```

```{r}
# Clapham Road Middle
crm_boxplot_whole_week <- clapham_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
)

ggplot(data = crm_boxplot_whole_week, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Clapham Road Middle (all hours)")
```

```{r}
# Daneland Walk
dw_boxplot_whole_week <- daneland_walk %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
)

ggplot(data = dw_boxplot_whole_week, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Daneland Walk (all hours)")
```

```{r}
# Edgware Road North
ern_boxplot_whole_week <- edgware_road_north_100027 %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
)

ggplot(data = ern_boxplot_whole_week, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Edgware Road North (all hours)")
```

```{r}
# Edgware Road South
ers_boxplot_whole_week <- edgware_road_south_100092 %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
)

ggplot(data = ers_boxplot_whole_week, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Edgware Road South (all hours)")
```

```{r}
# High Road Middle
hrm_boxplot_whole_week <- high_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
)

ggplot(data = hrm_boxplot_whole_week, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at High Road Middle (all hours)")
```

```{r}
# Kennington Road Middle
krm_boxplot_whole_week <- kennington_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
)

ggplot(data = krm_boxplot_whole_week, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Kennington Road Middle (all hours)")
```

```{r}
# Norwood Road South
nrs_boxplot_whole_week <- norwood_road_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
)

ggplot(data = nrs_boxplot_whole_week, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Norwood Road South (all hours)")
```

```{r}
# Oxford Street West
osw_boxplot_whole_week <- oxford_street_west %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
)

ggplot(data = osw_boxplot_whole_week, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Oxford Street West (all hours)")
```

```{r}
# Streatham High Road Middle
srhm_boxplot_whole_week <- streatham_high_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
)

ggplot(data = srhm_boxplot_whole_week, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Streatham High Road Middle (all hours)")
```

```{r}
# The Broadway
tb_boxplot_whole_week <- streatham_high_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
)

ggplot(data = tb_boxplot_whole_week, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at The Broadway (all hours)")
```

```{r}
# Wandsworth Road South
wrs_boxplot_whole_week <- wandsworth_road_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
)

ggplot(data = wrs_boxplot_whole_week, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Wandsworth Road South (all hours)")
```

### Weekdays (Monday to Friday)

```{r}
# Bruce Grove South
bgs_boxplot_weekdays <- bruce_grove_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = bgs_boxplot_weekdays, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays footfall distribution at Bruce Grove South")
```

```{r}
# Clapham High Street Middle
chsm_boxplot_weekdays <- clapham_high_street_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = chsm_boxplot_weekdays, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Clapham High Street Middle")
```

```{r}
# Clapham Road Middle
crm_boxplot_weekdays <- clapham_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = crm_boxplot_weekdays, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Clapham Road Middle")
```

```{r}
# Daneland Walk
dw_boxplot_weekdays <- daneland_walk %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = dw_boxplot_weekdays, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Daneland Walk")
```

```{r}
# Edgware Road North
ern_boxplot_weekdays <- edgware_road_north_100027 %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = ern_boxplot_weekdays, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Edgware Road North")
```

```{r}
# Edgware Road South
ers_boxplot_weekdays <- edgware_road_south_100092 %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = ers_boxplot_weekdays, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Edgware Road South")
```

```{r}
# High Road Middle
hrm_boxplot_weekdays <- high_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = hrm_boxplot_weekdays, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at High Road Middle")
```

```{r}
# Kennington Road Middle
krm_boxplot_weekdays <- kennington_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = krm_boxplot_weekdays, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Kennington Road Middle")
```

```{r}
# Norwood Road South
nrs_boxplot_weekdays <- norwood_road_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = nrs_boxplot_weekdays, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Norwood Road South")
```

```{r}
# Oxford Street West
osw_boxplot_weekdays <- oxford_street_west %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = osw_boxplot_weekdays, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Oxford Street West")
```

```{r}
# Streatham Road Middle
srm_boxplot_weekdays <- clapham_high_street_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = srm_boxplot_weekdays, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Streatham Road Middle")
```

```{r}
# The Broadway
tb_boxplot_weekdays <- clapham_high_street_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = tb_boxplot_weekdays, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at The Broadway")
```

```{r}
# Wandsworth Road South
wrs_boxplot_weekdays <- clapham_high_street_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = wrs_boxplot_weekdays, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Wandsworth Road South")
```

### Weekends (Saturday and Sunday)

```{r}
# Bruce Grove South
bgs_boxplot_weekends <- bruce_grove_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = bgs_boxplot_weekends, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Bruce Grove South")
```

```{r}
# Clapham High Street Middle
chsm_boxplot_weekends <- clapham_high_street_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = chsm_boxplot_weekends, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Clapham High Street Middle")
```

```{r}
# Clapham Road Middle
crm_boxplot_weekends <- clapham_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = crm_boxplot_weekends, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Clapham Road Middle")
```

```{r}
# Daneland Walk
dw_boxplot_weekends <- daneland_walk %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = dw_boxplot_weekends, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Daneland Walk")
```

```{r}
# Edgware Road North
ern_boxplot_weekends <- edgware_road_north_100027 %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = ern_boxplot_weekends, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Edgware Road North")
```

```{r}
# Edgware Road South
ers_boxplot_weekends <- edgware_road_south_100092 %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = ers_boxplot_weekends, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Edgware Road South")
```

```{r}
# High Road Middle
hrm_boxplot_weekends <- high_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = hrm_boxplot_weekends, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at High Road Middle")
```

```{r}
# Kennington Road Middle
krm_boxplot_weekends <- kennington_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = krm_boxplot_weekends, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Kennington Road Middle")
```

```{r}
# Norwood Road South
nrs_boxplot_weekends <- norwood_road_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = nrs_boxplot_weekends, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Norwood Road South")
```

```{r}
# Oxford Street West
osw_boxplot_weekends <- oxford_street_west %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = osw_boxplot_weekends, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Oxford Street West")
```

```{r}
# Streatham Road Middle
srm_boxplot_weekends <- streatham_high_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = srm_boxplot_weekends, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Streatham Road Middle")
```

```{r}
# The Broadway
tb_boxplot_weekends <- the_braodway %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = tb_boxplot_weekends, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at The Broadway")
```

```{r}
# Wandsworth Road South
wrs_boxplot_weekends <- wandsworth_road_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = wrs_boxplot_weekends, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Wandsworth Road South")
```

## Trading hours only (1000-1800)

### Whole week (Monday to Sunday)

```{r}
# Bruce Grove South
bgs_boxplot_week_tradinghours <- bruce_grove_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18)

ggplot(data = bgs_boxplot_week_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Bruce Grove South (trading hours)")
```

```{r}
# Clapham High Street Middle
chsm_boxplot_week_tradinghours <- clapham_high_street_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18)

ggplot(data = chsm_boxplot_week_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Clapham High Street Middle (trading hours)")
```

```{r}
# Clapham Road Middle
crm_boxplot_week_tradinghours <- clapham_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18)

ggplot(data = crm_boxplot_week_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Clapham Road Middle (trading hours)")
```

```{r}
# Daneland Walk
dw_boxplot_week_tradinghours <- daneland_walk %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18)

ggplot(data = dw_boxplot_week_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Daneland Walk (trading hours)")
```

```{r}
# Edgware Road North
ern_boxplot_week_tradinghours <- edgware_road_north_100027 %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18)

ggplot(data = ern_boxplot_week_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Edgware Road North (trading hours)")
```

```{r}
# Edgware Road South
ers_boxplot_week_tradinghours <- edgware_road_south_100092 %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18)

ggplot(data = ers_boxplot_week_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Edgware Road South (trading hours)")
```

```{r}
# High Road Middle
hrm_boxplot_week_tradinghours <- high_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18)

ggplot(data = hrm_boxplot_week_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at High Road Middle (trading hours)")
```

```{r}
# Kennington Road Middle
krm_boxplot_week_tradinghours <- kennington_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18)

ggplot(data = krm_boxplot_week_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Kennington Road Middle (trading hours)")
```

```{r}
# Norwood Road South
nrs_boxplot_week_tradinghours <- norwood_road_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18)

ggplot(data = nrs_boxplot_week_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Norwood Road South (trading hours)")
```

```{r}
# Oxford Street West
osw_boxplot_week_tradinghours <- oxford_street_west %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18)

ggplot(data = osw_boxplot_week_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Oxford Street West (trading hours)")
```

```{r}
# Streatham Road Middle
srm_boxplot_week_tradinghours <- streatham_high_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18)

ggplot(data = srm_boxplot_week_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Streatham Road Middle (trading hours)")
```

```{r}
# The Braodway
tb_boxplot_week_tradinghours <- the_braodway %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18)

ggplot(data = tb_boxplot_week_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at The Broadway (trading hours)")
```

```{r}
# Wandsworth Road South
wrs_boxplot_week_tradinghours <- wandsworth_road_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18)

ggplot(data = wrs_boxplot_week_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekly footfall distribution at Wandsworth Road South (trading hours)")
```

### Weekdays (Monday to Friday)

```{r}
# Bruce Grove South
bgs_boxplot_weekdays_tradinghours <- bruce_grove_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = bgs_boxplot_weekdays_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Bruce Grove South (trading hours)")
```

```{r}
# Clapham High Street Middle
chsm_boxplot_weekdays_tradinghours <- clapham_high_street_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = chsm_boxplot_weekdays_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Clapham High Street Middle (trading hours)")
```

```{r}
# Clapham Road Middle
crm_boxplot_weekdays_tradinghours <- clapham_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = crm_boxplot_weekdays_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Clapham Road Middle (trading hours)")
```

```{r}
# Daneland Walk
dw_boxplot_weekdays_tradinghours <- daneland_walk %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = dw_boxplot_weekdays_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Daneland Walk (trading hours)")
```

```{r}
# Edgware Road North
ern_boxplot_weekdays_tradinghours <- edgware_road_north_100027 %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = ern_boxplot_weekdays_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Edgware Road North (trading hours)")
```

```{r}
# Edgware Road South 
ers_boxplot_weekdays_tradinghours <- edgware_road_south_100092 %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = ers_boxplot_weekdays_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Edgware Road South (trading hours)")
```

```{r}
# High Road Middle
hrm_boxplot_weekdays_tradinghours <- high_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = hrm_boxplot_weekdays_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at High Road Middle (trading hours)")
```

```{r}
# Kennington Road Middle
krm_boxplot_weekdays_tradinghours <- kennington_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = krm_boxplot_weekdays_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Kennington Road Middle (trading hours)")
```

```{r}
# Norwood Road South
nrs_boxplot_weekdays_tradinghours <- norwood_road_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = nrs_boxplot_weekdays_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Norwood Road South (trading hours)")
```

```{r}
# Oxford Street West 
osw_boxplot_weekdays_tradinghours <- oxford_street_west %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = osw_boxplot_weekdays_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Oxford Street West (trading hours)")
```

```{r}
# Streatham Road Middle
srm_boxplot_weekdays_tradinghours <- streatham_high_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = srm_boxplot_weekdays_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Streatham Road Middle (trading hours)")
```

```{r}
# The Broadway
tb_boxplot_weekdays_tradinghours <- the_braodway %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = tb_boxplot_weekdays_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at The Broadway (trading hours)")
```

```{r}
# Wandsworth Road South
wrs_boxplot_weekdays_tradinghours <- wandsworth_road_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

ggplot(data = wrs_boxplot_weekdays_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekdays Footfall distribution at Wandsworth Road South (trading hours)")
```

### Weekends (Saturday and Sunday)

```{r}
# Bruce Grove South
bgs_boxplot_weekends_tradinghours <- bruce_grove_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = bgs_boxplot_weekends_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Bruce Grove South (trading hours)")
```

```{r}
# Clapham High Street Middle
chsm_boxplot_weekends_tradinghours <- clapham_high_street_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = chsm_boxplot_weekends_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Clapham High Street Middle (trading hours)")
```

```{r}
# Clapham Road Middle
crm_boxplot_weekends_tradinghours <- clapham_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = crm_boxplot_weekends_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Clapham Road Middle (trading hours)")
```

```{r}
# Daneland Walk
dw_boxplot_weekends_tradinghours <- daneland_walk %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = dw_boxplot_weekends_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Daneland Walk (trading hours)")
```

```{r}
# Edgware Road North
ern_boxplot_weekends_tradinghours <- edgware_road_north_100027 %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = ern_boxplot_weekends_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Edgware Road North (trading hours)")
```

```{r}
# Edgware Road South
ers_boxplot_weekends_tradinghours <- edgware_road_south_100092 %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = ers_boxplot_weekends_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Edgware Road South (trading hours)")
```

```{r}
# High Road Middle
hrm_boxplot_weekends_tradinghours <- high_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = hrm_boxplot_weekends_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at High Road Middle (trading hours)")
```

```{r}
# Kennington Road Middle
krm_boxplot_weekends_tradinghours <- kennington_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = krm_boxplot_weekends_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Kennington Road Middle (trading hours)")
```

```{r}
# Norwood Road South
nrs_boxplot_weekends_tradinghours <- norwood_road_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = nrs_boxplot_weekends_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Norwood Road South (trading hours)")
```

```{r}
# Oxford Street West 
osw_boxplot_weekends_tradinghours <- oxford_street_west %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = osw_boxplot_weekends_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Oxford Street West (trading hours)")
```

```{r}
# Streatham Road Middle
srm_boxplot_weekends_tradinghours <- streatham_high_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = srm_boxplot_weekends_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Streatham Road Middle (trading hours)")
```

```{r}
# The Broadway
tb_boxplot_weekends_tradinghours <- the_braodway %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = tb_boxplot_weekends_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at The Broadway (trading hours)")
```

```{r}
# Wandsworth Road South
wrs_boxplot_weekends_tradinghours <- wandsworth_road_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
) %>%
  filter(time >= 10 & time <= 18) %>%
  filter(weekday %in% c("Saturday", "Sunday"))

ggplot(data = wrs_boxplot_weekends_tradinghours, 
       aes( x = weekday, y = footfall_sum)) +
  geom_boxplot() +
  xlab("Day of the week") +
  ylab("Footfall count") +
  labs(title = "Weekends Footfall distribution at Wandsworth Road South (trading hours)")
```

# Weekly footfall distribution -- summary descriptive statistics

## Whole day (24 hours)

```{r}
# Calculating mean max and min for summary statistics analysis

# Bruce Grove South
bgs_whole_stat <- bruce_grove_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

chsm_whole_stat <- clapham_high_street_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

crm_whole_stat <- clapham_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

dw_whole_stat <- daneland_walk %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

ern_whole_stat <- edgware_road_north_100027 %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

ers_whole_stat <- edgware_road_south_100092 %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

hrm_whole_stat <- high_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

krm_whole_stat <- kennington_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

nrs_whole_stat <- norwood_road_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

osw_whole_stat <- oxford_street_west %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

srm_whole_stat <- streatham_high_road_middle %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

tb_whole_stat <- the_braodway %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

wrs_whole_stat <- wandsworth_road_south %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )
```

### Whole week (Monday to Sunday)

```{r}
# Bruce Grove South
# Bar graph and line graph 
primary_y_limits <- c(0, max(bgs_whole_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
 secondary_y_limits <- c(0, 20)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(bgs_whole_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Cumulative footfall count across months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ mean/ median/ min footfall count")
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Bruce Grove South",
    x = "Day of the Week",
    y = "Cumulative Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Clapham High Street Middle
# Bar graph and line graph 
primary_y_limits <- c(0, max(chsm_whole_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(chsm_whole_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Cumulative footfall count across months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ mean/ median/ min footfall count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Clapham High Street Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Clapham Road Middle
# Bar graph and line graph 
primary_y_limits <- c(0, max(crm_whole_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1000)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(crm_whole_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Cumulative footfall count across months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ mean/ median/ min footfall count", breaks = seq(0, 1000, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Clapham Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Bar graph and line graph 
primary_y_limits <- c(0, max(dw_whole_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1400)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(dw_whole_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Cumulative footfall count across months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ mean/ median/ min footfall count", breaks = seq(0, 1400, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Daneland Walk",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Edgware Road North
# Bar graph and line graph 
primary_y_limits <- c(0, max(ern_whole_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1400)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(ern_whole_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Cumulative footfall count across months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ mean/ median/ min footfall count", breaks = seq(0, 1400, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Edgware Road North",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Edgware Road South
# Bar graph and line graph 
primary_y_limits <- c(0, max(ers_whole_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1400)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(ers_whole_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Cumulative footfall count across months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ mean/ median/ min footfall count", breaks = seq(0, 1400, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Edgware Road South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# High Road Middle
# Bar graph and line graph 
primary_y_limits <- c(0, max(hrm_whole_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 3200)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(hrm_whole_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Cumulative footfall count across months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ mean/ median/ min footfall count", breaks = seq(0, 3200, by = 200))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "High Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Kennington Road Middle
# Bar graph and line graph 
primary_y_limits <- c(0, max(krm_whole_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 700)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(krm_whole_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Cumulative footfall count across months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ mean/ median/ min footfall count", breaks = seq(0, 700, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Kennington Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Norwood Road South
# Bar graph and line graph 
primary_y_limits <- c(0, max(nrs_whole_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 700)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(nrs_whole_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Cumulative footfall count across months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ mean/ median/ min footfall count", breaks = seq(0, 700, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Norwood Road South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Oxford Street West
# Bar graph and line graph 
primary_y_limits <- c(0, max(osw_whole_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 500)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(osw_whole_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Cumulative footfall count across months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ mean/ median/ min Footfall Count", breaks = seq(0, 500, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Oxford Street West",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Streatham Road Middle
# Bar graph and line graph 
primary_y_limits <- c(0, max(srm_whole_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 100)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(srm_whole_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Cumulative footfall count across months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ mean/ median/ min Footfall Count", breaks = seq(0, 100, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Streatham High Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# The Broadway
# Bar graph and line graph 
primary_y_limits <- c(0, max(tb_whole_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 900)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(tb_whole_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Cumulative footfall count across months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ mean/ median/ min footfall count", breaks = seq(0, 900, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "The Broadway",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Wandsworth Road South
# Bar graph and line graph 
primary_y_limits <- c(0, max(wrs_whole_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1300)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(wrs_whole_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Cumulative footfall count across months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ mean/ median/ min footfall count", breaks = seq(0, 1300, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Wandsworth Road South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

### Weekdays (Monday to Friday)

```{r}
bgs_weekdays_stat <- bgs_whole_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(bgs_weekdays_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(bgs_weekdays_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays at Bruce Grove South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Clapham High Street Middle
chsm_weekdays_stat <- chsm_whole_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(chsm_weekdays_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(chsm_weekdays_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays at Clapham High Street Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Clapham Road Middle
crm_weekdays_stat <- crm_whole_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(crm_weekdays_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(crm_weekdays_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays at Clapham Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Daneland Walk
dw_weekdays_stat <- dw_whole_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(dw_weekdays_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(dw_weekdays_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays at Daneland Walk",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Edgware Road North
ern_weekdays_stat <- ern_whole_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(ern_weekdays_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(ern_weekdays_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays at Edgware Road North",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Edgware Road South
ers_weekdays_stat <- ers_whole_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(ers_weekdays_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(ers_weekdays_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays at Edgware Road South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# High Road Middle
hrm_weekdays_stat <- hrm_whole_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(hrm_weekdays_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 2600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(hrm_weekdays_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 2600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays at High Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Kennington Road Middle
krm_weekdays_stat <- krm_whole_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(krm_weekdays_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(krm_weekdays_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays at Kennington Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Norwoord Road South
nrs_weekdays_stat <- nrs_whole_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(nrs_weekdays_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(nrs_weekdays_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays at Norwood Road South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Oxford Street West
osw_weekdays_stat <- osw_whole_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(osw_weekdays_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(osw_weekdays_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays at Oxford Stret West",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Streatham Road Middle
srm_weekdays_stat <- srm_whole_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(srm_weekdays_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(srm_weekdays_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays at Streatham Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# The Broadway
tb_weekdays_stat <- tb_whole_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(tb_weekdays_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(tb_weekdays_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays at The Broadway",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Wandsworth Road South
wrs_weekdays_stat <- wrs_whole_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(wrs_weekdays_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(wrs_weekdays_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays at Wandsworth South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

### Weekends (Saturday and Sunday)

```{r}
# Bruce Grove South
bgs_weekends_stat <- bgs_whole_stat %>%
  filter(weekday %in% c("Saturday", "Sunday"))

primary_y_limits <- c(0, max(bgs_weekends_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(bgs_weekends_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekends at Bruce Grove South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

## Trading hours only (1000-1800)

```{r}
# Calculating mean max and min for summary statistics analysis

bgs_tradinghrs_stat <- bruce_grove_south %>%
  filter(time >= 10 & time <= 18) %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

chsm_tradinghrs_stat <- clapham_high_street_middle %>%
  filter(time >= 10 & time <= 18) %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

crm_tradinghrs_stat <- clapham_road_middle %>%
  filter(time >= 10 & time <= 18) %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

dw_tradinghrs_stat <- daneland_walk %>%
  filter(time >= 10 & time <= 18) %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

ern_tradinghrs_stat <- edgware_road_north_100027 %>%
  filter(time >= 10 & time <= 18) %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

ers_tradinghrs_stat <- edgware_road_south_100092 %>%
  filter(time >= 10 & time <= 18) %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

hrm_tradinghrs_stat <- high_road_middle %>%
  filter(time >= 10 & time <= 18) %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

krm_tradinghrs_stat <- kennington_road_middle %>%
  filter(time >= 10 & time <= 18) %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

nrs_tradinghrs_stat <- norwood_road_south %>%
  filter(time >= 10 & time <= 18) %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

osw_tradinghrs_stat <- oxford_street_west %>%
  filter(time >= 10 & time <= 18) %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

srm_tradinghrs_stat <- streatham_high_road_middle %>%
  filter(time >= 10 & time <= 18) %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

tb_tradinghrs_stat <- the_braodway %>%
  filter(time >= 10 & time <= 18) %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )

wrs_tradinghrs_stat <- wandsworth_road_south %>%
  filter(time >= 10 & time <= 18) %>%
  mutate(
    weekday = factor(weekday, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  ) %>%
  group_by(weekday) %>%
  summarise(
    total_footfall = sum(footfall_sum, na.rm = TRUE),
    avg_footfall = mean(footfall_sum, na.rm = TRUE),
    max_footfall = max(footfall_sum, na.rm = TRUE),
    min_footfall = min(footfall_sum, na.rm = TRUE),
    median_footfall = median(footfall_sum, na.rm = TRUE),
    count = n()
  )
```

### Whole week (Monday to Sunday)

```{r}
# Bruce Grove South
# Bar graph and line graph 
primary_y_limits <- c(0, max(bgs_tradinghrs_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(bgs_tradinghrs_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics by Day of the Week at Bruce Grove South (trading hours)",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Clapham High Street Middle
# Bar graph and line graph 
primary_y_limits <- c(0, max(chsm_tradinghrs_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(chsm_tradinghrs_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics by Day of the Week Clapham High Street Middle (trading hours)",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Clapham Road Middle
# Bar graph and line graph 
primary_y_limits <- c(0, max(crm_tradinghrs_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(crm_tradinghrs_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics by Day of the Week at Clapham Road Middle (trading hours)",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Daneland Walk
# Bar graph and line graph 
primary_y_limits <- c(0, max(dw_tradinghrs_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(dw_tradinghrs_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics by Day of the Week at Daneland Walk (trading hours)",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Edgware Road North
# Bar graph and line graph 
primary_y_limits <- c(0, max(ern_tradinghrs_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(ern_tradinghrs_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics by Day of the Week at Edgware Road North (trading hours)",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Edgware Road South
# Bar graph and line graph 
primary_y_limits <- c(0, max(ers_tradinghrs_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(ers_tradinghrs_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics by Day of the Week at Edgware Road South (trading hours)",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# High Road Middle
# Bar graph and line graph 
primary_y_limits <- c(0, max(hrm_tradinghrs_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 3200)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(hrm_tradinghrs_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 3200, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics by Day of the Week at High Road Middle (trading hours)",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Kennington Road Middle
# Bar graph and line graph 
primary_y_limits <- c(0, max(krm_tradinghrs_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(krm_tradinghrs_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics by Day of the Week at Kennington Road Middle (trading hours)",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Norwood Road South
# Bar graph and line graph 
primary_y_limits <- c(0, max(nrs_tradinghrs_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(nrs_tradinghrs_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics by Day of the Week at Norwood Road South (trading hours)",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Oxford Street West 
# Bar graph and line graph 
primary_y_limits <- c(0, max(osw_tradinghrs_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(osw_tradinghrs_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics by Day of the Week at Oxford Street West (trading hours)",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Streatham Road Middle
# Bar graph and line graph 
primary_y_limits <- c(0, max(srm_tradinghrs_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(srm_tradinghrs_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics by Day of the Week Streatham High Road Middle (trading hours)",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# The Broadway
# Bar graph and line graph 
primary_y_limits <- c(0, max(tb_tradinghrs_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(tb_tradinghrs_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics by Day of the Week at The Broadway (trading hours)",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Wandsworth Road South
# Bar graph and line graph 
primary_y_limits <- c(0, max(wrs_tradinghrs_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(wrs_tradinghrs_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics by Day of the Week at Wandsworth Road South (trading hours)",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

### Weekdays (Monday to Friday)

```{r}
# Bruce Grove South
bgs_weekdays_th_stat <- bgs_tradinghrs_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(bgs_weekdays_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(bgs_weekdays_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays (trading hours) at Bruce Grove South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Clapham High Street Middle
chsm_weekdays_th_stat <- chsm_tradinghrs_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(chsm_weekdays_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(chsm_weekdays_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays (trading hours) at Clapham High Street Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Clapham Road Middle
crm_weekdays_th_stat <- crm_tradinghrs_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(crm_weekdays_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(crm_weekdays_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays (trading hours) at Clapham Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Daneland Walk
dw_weekdays_th_stat <- dw_tradinghrs_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(dw_weekdays_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(dw_weekdays_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays (trading hours) at Danelwand Walk",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Edgware Road North
ern_weekdays_th_stat <- ern_tradinghrs_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(ern_weekdays_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(ern_weekdays_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays (trading hours) at Edgware Road North",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Edgware Road South
ers_weekdays_th_stat <- ers_tradinghrs_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(ers_weekdays_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(ers_weekdays_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays (trading hours) at Edgware Road South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# High Road Middle
hrm_weekdays_th_stat <- hrm_tradinghrs_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(hrm_weekdays_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 3200)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(hrm_weekdays_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 3200, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays (trading hours) at High Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Kennington Road Middle
krm_weekdays_th_stat <- krm_tradinghrs_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(krm_weekdays_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(krm_weekdays_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays (trading hours) at Kennington Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Norwood Road South
nrs_weekdays_th_stat <- nrs_tradinghrs_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(nrs_weekdays_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(nrs_weekdays_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays (trading hours) at Norwood Road South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Oxford Street West
osw_weekdays_th_stat <- osw_tradinghrs_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(osw_weekdays_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(osw_weekdays_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays (trading hours) at Oxford Street West",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Streatham Road Middle
srm_weekdays_th_stat <- srm_tradinghrs_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(srm_weekdays_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(srm_weekdays_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays (trading hours) at Streatham Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# The Broadway
tb_weekdays_th_stat <- tb_tradinghrs_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(tb_weekdays_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(tb_weekdays_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays (trading hours) at The Broadway",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Wandsworth Road South
wrs_weekdays_th_stat <- wrs_tradinghrs_stat %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))

primary_y_limits <- c(0, max(wrs_weekdays_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(wrs_weekdays_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekdays (trading hours) at Wandsworth Road South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

### Weekends (Saturday and Sunday)

```{r}
# Bruce Grove South
bgs_weekends_th_stat <- bgs_tradinghrs_stat %>%
  filter(weekday %in% c("Saturday", "Sunday"))

primary_y_limits <- c(0, max(bgs_weekends_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(bgs_weekends_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekends (trading hours) at Bruce Grove South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Clapham High Street Middle
chsm_weekends_th_stat <- chsm_tradinghrs_stat %>%
  filter(weekday %in% c("Saturday", "Sunday"))

primary_y_limits <- c(0, max(chsm_weekends_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(chsm_weekends_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekends (trading hours) at Clapham High Street Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Clapham Road Middle
crm_weekends_th_stat <- crm_tradinghrs_stat %>%
  filter(weekday %in% c("Saturday", "Sunday"))

primary_y_limits <- c(0, max(crm_weekends_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(crm_weekends_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekends (trading hours) at Clapham Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Daneland Walk
dw_weekends_th_stat <- dw_tradinghrs_stat %>%
  filter(weekday %in% c("Saturday", "Sunday"))

primary_y_limits <- c(0, max(dw_weekends_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(dw_weekends_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekends (trading hours) at Daneland Walk",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Edgware Road North
ern_weekends_th_stat <- ern_tradinghrs_stat %>%
  filter(weekday %in% c("Saturday", "Sunday"))

primary_y_limits <- c(0, max(ern_weekends_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(ern_weekends_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekends (trading hours) at Edgware Road North",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Edgware Road South
ers_weekends_th_stat <- ers_tradinghrs_stat %>%
  filter(weekday %in% c("Saturday", "Sunday"))

primary_y_limits <- c(0, max(ers_weekends_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(ers_weekends_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekends (trading hours) at Edgware Road South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# High Road Middle
hrm_weekends_th_stat <- hrm_tradinghrs_stat %>%
  filter(weekday %in% c("Saturday", "Sunday"))

primary_y_limits <- c(0, max(hrm_weekends_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 3200)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(hrm_weekends_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 3200, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekends (trading hours) at High Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Kennington Road Middle
krm_weekends_th_stat <- krm_tradinghrs_stat %>%
  filter(weekday %in% c("Saturday", "Sunday"))

primary_y_limits <- c(0, max(krm_weekends_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(krm_weekends_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekends (trading hours) at Kennington Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Norwood Road South
nrs_weekends_th_stat <- nrs_tradinghrs_stat %>%
  filter(weekday %in% c("Saturday", "Sunday"))

primary_y_limits <- c(0, max(nrs_weekends_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(nrs_weekends_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekends (trading hours) at Norwood Road South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Oxford Street West
osw_weekends_th_stat <- osw_tradinghrs_stat %>%
  filter(weekday %in% c("Saturday", "Sunday"))

primary_y_limits <- c(0, max(osw_weekends_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(osw_weekends_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekends (trading hours) at Oxford Street West",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Streatham Road Middle
srm_weekends_th_stat <- srm_tradinghrs_stat %>%
  filter(weekday %in% c("Saturday", "Sunday"))

primary_y_limits <- c(0, max(srm_weekends_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(srm_weekends_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekends (trading hours) at Streatham Road Middle",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# The Broadway
tb_weekends_th_stat <- tb_tradinghrs_stat %>%
  filter(weekday %in% c("Saturday", "Sunday"))

primary_y_limits <- c(0, max(tb_weekends_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(tb_weekends_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekends (trading hours) at The Broadway",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

```{r}
# Wandsworth Road South
wrs_weekends_th_stat <- wrs_tradinghrs_stat %>%
  filter(weekday %in% c("Saturday", "Sunday"))

primary_y_limits <- c(0, max(wrs_weekends_th_stat$total_footfall, na.rm = TRUE))

# Manually define the secondary y-axis limits
secondary_y_limits <- c(0, 1600)

# Calculate the scaling factor based on the defined limits
scaling_factor <- primary_y_limits[2] / secondary_y_limits[2]

# Plot the data with combined bar and line graph
ggplot(wrs_weekends_th_stat, aes(x = weekday)) +
  geom_bar(aes(y = total_footfall, fill = "Total Footfall"), stat = "identity", width = 0.5) +
  geom_line(aes(y = avg_footfall * scaling_factor, color = "Mean"), size = 1, group = 1) +
  geom_line(aes(y = max_footfall * scaling_factor, color = "Max"), size = 1, group = 1) +
  geom_line(aes(y = min_footfall * scaling_factor, color = "Min"), size = 1, group = 1) +
  geom_line(aes(y = median_footfall * scaling_factor, color = "Median"), size = 1, group = 1) +
  scale_y_continuous(
    name = "Total Footfall Count Across the Months",
    limits = primary_y_limits,
    sec.axis = sec_axis(~ . / scaling_factor, name = "Max/ Mean/ Median/ Min Footfall Count", breaks = seq(0, 1600, by = 100))
  ) +
  scale_fill_manual(name = "Footfall", values = c("Total Footfall" = "gray")) +
  scale_color_manual(name = "Statistics", values = c("Mean" = "blue", "Max" = "red", "Min" = "green", "Median" = "orange")) +
  labs(
    title = "Footfall Statistics during weekends (trading hours) at Wandsworth Road South",
    x = "Day of the Week",
    y = "Total Footfall Count"
  ) +
  theme_minimal()
```

# Comparison

```{r}
# All hours
bgs_whole_stat$street <- "Bruce Grove South"
chsm_whole_stat$street <- "Clapham High Street Middle"
crm_whole_stat$street <- "Clapham Road Middle"
dw_whole_stat$street <- "Daneland Walk"
ern_whole_stat$street <- "Edgware Road North"
ers_whole_stat$street <- "Edgware Road South"
hrm_whole_stat$street <- "High Road Middle"
krm_whole_stat$street <- "Kennington Road Middle"
nrs_whole_stat$street <- "Norwood Road South"
osw_whole_stat$street <- "Oxford Street West"
srm_whole_stat$street <- "Streatham High Road Middle"
tb_whole_stat$street <- "The Broadway"
wrs_whole_stat$street <- "Wandsworth Road South"

# Trading hours
bgs_tradinghrs_stat$street <- "Bruce Grove South"
chsm_tradinghrs_stat$street <- "Clapham High Street Middle"
crm_tradinghrs_stat$street <- "Clapham Road Middle"
dw_tradinghrs_stat$street <- "Daneland Walk"
ern_tradinghrs_stat$street <- "Edgware Road North"
ers_tradinghrs_stat$street <- "Edgware Road South"
hrm_tradinghrs_stat$street <- "High Road Middle"
krm_tradinghrs_stat$street <- "Kennington Road Middle"
nrs_tradinghrs_stat$street <- "Norwood Road South"
osw_tradinghrs_stat$street <- "Oxford Street West"
srm_tradinghrs_stat$street <- "Streatham High Road Middle"
tb_tradinghrs_stat$street <- "The Broadway"
wrs_tradinghrs_stat$street <- "Wandsworth Road South"

# Combining them together for plotting/ comparing/ and spatial autocorrelation
combined_whole_stat <- rbind(bgs_whole_stat, chsm_whole_stat, crm_whole_stat, dw_whole_stat, ern_whole_stat, ers_whole_stat, hrm_whole_stat, krm_whole_stat, nrs_whole_stat, osw_whole_stat, srm_whole_stat, tb_whole_stat, wrs_whole_stat)
combined_whole_stat <- combined_whole_stat %>% select(street, weekday, total_footfall, avg_footfall, max_footfall, min_footfall, count)

combined_tradinghrs_stat <- rbind(bgs_tradinghrs_stat, chsm_tradinghrs_stat, crm_tradinghrs_stat, dw_tradinghrs_stat, ern_tradinghrs_stat, ers_tradinghrs_stat, hrm_tradinghrs_stat, krm_tradinghrs_stat, nrs_tradinghrs_stat, osw_tradinghrs_stat, srm_tradinghrs_stat, tb_tradinghrs_stat, wrs_tradinghrs_stat)
combined_tradinghrs_stat <- combined_tradinghrs_stat %>% select(street, weekday, total_footfall, avg_footfall, max_footfall, min_footfall, count)
```




# Long-term time series analysis

```{r}
# Normalise
#columns_to_normalise <- ff_2022[c("footfall_sum")]
#process_timeseries <- preProcess(columns_to_normalise, method = c("range"))
#normalized_ff <- predict(process_timeseries, columns_to_normalise)

#normalized_footfall_2022 <- normalized_footfall_2022 %>%
#  rename(normalised_ff_sum = normalized_ff$footfall_sum)
#normalized_footfall_2022 <- cbind(ff_2022, normalized_ff$footfall_sum)

#write.csv(normalized_footfall_2022, file = "normalized_footfall_2022.csv", row.names = FALSE)

#process_timeseries <- preProcess(as.data.frame(ff_2022), method=c("range"))

#norm_timeseries <- predict(process_timeseries, as.data.frame(ff_2022))

normalised_ff_2022 <- read_csv(here::here("normalized_footfall_2022.csv"))
```


```{r}
# Bruce Grove South
bgs_ff_allhrs <- ff_2022 %>%
  filter(street == "Bruce Grove South")

ggplot(bgs_ff_allhrs, aes(x = date, y = footfall_sum)) +
  geom_line(color = "blue", size = 0.5) +  # Line color and size
  #geom_point(color = "blue", size = 2) +  # Points on the line
  labs(title = "Footfall Distribution for Bruce Grove South", x = "Date", y = "Footfall Count") +
  theme_minimal() 
  #scale_y_continuous(breaks = seq(0, max(bgs_ff$footfall_sum), by = 10)
```

```{r}
bgs_ff_allhrs <- normalised_ff_2022 %>%
  filter(street == "Bruce Grove South")

ggplot(bgs_ff_allhrs, aes(x = date, y = footfall_sum)) +
  geom_line(color = "blue", size = 0.5) +  # Line color and size
  #geom_point(color = "blue", size = 2) +  # Points on the line
  labs(title = "Footfall Distribution for Bruce Grove South", x = "Date", y = "Footfall Count") +
  theme_minimal() 
  #scale_y_continuous(breaks = seq(0, max(bgs_ff$footfall_sum), by = 10)
```

```{r}
# Clapham High Street Middle
chsm_ff_allhrs <- ff_2022 %>%
  filter(street == "Clapham High Street Middle")

ggplot(chsm_ff_allhrs, aes(x = date, y = footfall_sum)) +
  geom_line(color = "blue", size = 0.5) +  # Line color and size
  #geom_point(color = "blue", size = 2) +  # Points on the line
  labs(title = "Footfall Distribution for Clapham High Stret Middle", x = "Date", y = "Footfall Count") +
  theme_minimal() 
  #scale_y_continuous(breaks = seq(0, max(bgs_ff$footfall_sum), by = 10)
```

```{r}
# Clapham Road Middle
crm_ff_allhrs <- ff_2022 %>%
  filter(street == "Clapham Road Middle")

ggplot(crm_ff_allhrs, aes(x = date, y = footfall_sum)) +
  geom_line(color = "blue", size = 0.5) +  # Line color and size
  #geom_point(color = "blue", size = 2) +  # Points on the line
  labs(title = "Footfall Distribution for Clapham Road Middle", x = "Date", y = "Footfall Count") +
  theme_minimal() 
```

```{r}
# Daneland Walk
dw_ff_allhrs <- ff_2022 %>%
  filter(street == "Daneland Walk")

ggplot(dw_ff_allhrs, aes(x = date, y = footfall_sum)) +
  geom_line(color = "blue", size = 0.5) +  # Line color and size
  #geom_point(color = "blue", size = 2) +  # Points on the line
  labs(title = "Footfall Distribution for Daneland Walk", x = "Date", y = "Footfall Count") +
  theme_minimal() 
```

```{r}
# Edgware Road North
ern_ff_allhrs <- ff_2022 %>%
  filter(street == "Edgware Road North")

ggplot(ern_ff_allhrs, aes(x = date, y = footfall_sum)) +
  geom_line(color = "blue", size = 0.5) +  # Line color and size
  #geom_point(color = "blue", size = 2) +  # Points on the line
  labs(title = "Footfall Distribution for Edgware Road North", x = "Date", y = "Footfall Count") +
  theme_minimal() 
```

```{r}
# Edgware Road South
ers_ff_allhrs <- ff_2022 %>%
  filter(street == "Edgware Road South")

ggplot(ers_ff_allhrs, aes(x = date, y = footfall_sum)) +
  geom_line(color = "blue", size = 0.5) +  # Line color and size
  #geom_point(color = "blue", size = 2) +  # Points on the line
  labs(title = "Footfall Distribution for Edgware Road South", x = "Date", y = "Footfall Count") +
  theme_minimal() 
```

```{r}
# High Road Middle
hrm_ff_allhrs <- ff_2022 %>%
  filter(street == "High Road Middle")

ggplot(hrm_ff_allhrs, aes(x = date, y = footfall_sum)) +
  geom_line(color = "blue", size = 0.5) +  # Line color and size
  #geom_point(color = "blue", size = 2) +  # Points on the line
  labs(title = "Footfall Distribution for High Road Middle", x = "Date", y = "Footfall Count") +
  theme_minimal() 
```

```{r}
# Kennington Road Middle
krm_ff_allhrs <- ff_2022 %>%
  filter(street == "Kennington Road Middle")

ggplot(krm_ff_allhrs, aes(x = date, y = footfall_sum)) +
  geom_line(color = "blue", size = 0.5) +  # Line color and size
  #geom_point(color = "blue", size = 2) +  # Points on the line
  labs(title = "Footfall Distribution for Kennington Road Middle", x = "Date", y = "Footfall Count") +
  theme_minimal() 
```

```{r}
# Norwood Road South
nrs_ff_allhrs <- ff_2022 %>%
  filter(street == "Norwood Road South")

ggplot(nrs_ff_allhrs, aes(x = date, y = footfall_sum)) +
  geom_line(color = "blue", size = 0.5) +  # Line color and size
  #geom_point(color = "blue", size = 2) +  # Points on the line
  labs(title = "Footfall Distribution for Norwood Road South", x = "Date", y = "Footfall Count") +
  theme_minimal() 
```

```{r}
# Oxford Street West
osw_ff_allhrs <- ff_2022 %>%
  filter(street == "Oxford Street West")

ggplot(osw_ff_allhrs, aes(x = date, y = footfall_sum)) +
  geom_line(color = "blue", size = 0.5) +  # Line color and size
  #geom_point(color = "blue", size = 2) +  # Points on the line
  labs(title = "Footfall Distribution for Oxford Street West", x = "Date", y = "Footfall Count") +
  theme_minimal() 
```

```{r}
# Streatham High Road Middle
shrm_ff_allhrs <- ff_2022 %>%
  filter(street == "Streatham High Road Middle")

ggplot(shrm_ff_allhrs, aes(x = date, y = footfall_sum)) +
  geom_line(color = "blue", size = 0.5) +  # Line color and size
  #geom_point(color = "blue", size = 2) +  # Points on the line
  labs(title = "Footfall Distribution for Streatham High Road Middle", x = "Date", y = "Footfall Count") +
  theme_minimal() 
```

```{r}
# The Broadway
tb_ff_allhrs <- ff_2022 %>%
  filter(street == "The Broadway")

ggplot(tb_ff_allhrs, aes(x = date, y = footfall_sum)) +
  geom_line(color = "blue", size = 0.5) +  # Line color and size
  #geom_point(color = "blue", size = 2) +  # Points on the line
  labs(title = "Footfall Distribution for The Broadway", x = "Date", y = "Footfall Count") +
  theme_minimal() 
```

```{r}
# Wandsworth Road South
wrs_ff_allhrs <- ff_2022 %>%
  filter(street == "Wandsworth Road South")

ggplot(wrs_ff_allhrs, aes(x = date, y = footfall_sum)) +
  geom_line(color = "blue", size = 0.5) +  # Line color and size
  #geom_point(color = "blue", size = 2) +  # Points on the line
  labs(title = "Footfall Distribution for Wandworth Road South", x = "Date", y = "Footfall Count") +
  theme_minimal() 
```



# All hour time series

```{r}
bgs_ff <- ff_2022 %>%
  filter(street == "Bruce Grove South")
chsm_ff <- ff_2022 %>%
  filter(street == "Clapham High Street Middle")
crm_ff <- ff_2022 %>%
  filter(street == "Clapham Road Middle")
dw_ff <- ff_2022 %>%
  filter(street == "Daneland Walk")
ern_ff <- ff_2022 %>%
  filter(street == "Edgware Road North")
ers_ff <- ff_2022 %>%
  filter(street == "Edgware Road South")
hrm_ff <- ff_2022 %>%
  filter(street == "High Road Middle")
krm_ff <- ff_2022 %>%
  filter(street == "Kennington Road Middle")
nrs_ff <- ff_2022 %>%
  filter(street == "Norwood Road South")
osw_ff <- ff_2022 %>%
  filter(street == "Oxford Street West")
shrm_ff <- ff_2022 %>%
  filter( street == "Streatham High Road Middle")
tb_ff <- ff_2022 %>%
  filter(street == "The Broadway")
wrs_ff <- ff_2022 %>%
  filter(street == "Wandsworth Road South")
```

```{r}
bgs_ff_norm <- normalised_ff_2022 %>%
  filter(street == "Bruce Grove South")
chsm_ff_norm <- normalised_ff_2022 %>%
  filter(street == "Clapham High Street Middle")
crm_ff_norm <- normalised_ff_2022 %>%
  filter(street == "Clapham Road Middle")
dw_ff_norm <- normalised_ff_2022 %>%
  filter(street == "Daneland Walk")
ern_ff_norm <- normalised_ff_2022 %>%
  filter(street == "Edgware Road North")
ers_ff_norm <- normalised_ff_2022 %>%
  filter(street == "Edgware Road South")
hrm_ff_norm <- normalised_ff_2022 %>%
  filter(street == "High Road Middle")
krm_ff_norm <- normalised_ff_2022 %>%
  filter(street == "Kennington Road Middle")
nrs_ff_norm <- normalised_ff_2022 %>%
  filter(street == "Norwood Road South")
osw_ff_norm <- normalised_ff_2022 %>%
  filter(street == "Oxford Street West")
shrm_ff_norm <- normalised_ff_2022 %>%
  filter( street == "Streatham High Road Middle")
tb_ff_norm <- normalised_ff_2022 %>%
  filter(street == "The Broadway")
wrs_ff_norm <- normalised_ff_2022 %>%
  filter(street == "Wandsworth Road South")
```

```{r}
# All days
bgs_ff_hour <- bgs_ff %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
chsm_ff_hour <- chsm_ff %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
crm_ff_hour <- crm_ff %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
dw_ff_hour <- dw_ff %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ern_ff_hour <- ern_ff %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ers_ff_hour <- ers_ff %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
hrm_ff_hour <- hrm_ff %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
krm_ff_hour <- krm_ff %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
nrs_ff_hour <- nrs_ff %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
osw_ff_hour <- osw_ff %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
shrm_ff_hour <- shrm_ff %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
tb_ff_hour <- tb_ff %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
wrs_ff_hour <- wrs_ff %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
```

```{r}
# All days, normalised
bgs_ff_hour_norm <- bgs_ff_norm %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
chsm_ff_hour_norm <- chsm_ff_norm %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
crm_ff_hour_norm <- crm_ff_norm %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
dw_ff_hour_norm <- dw_ff_norm %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ern_ff_hour_norm <- ern_ff_norm %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ers_ff_hour_norm <- ers_ff_norm %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
hrm_ff_hour_norm <- hrm_ff_norm %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
krm_ff_hour_norm <- krm_ff_norm %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
nrs_ff_hour_norm <- nrs_ff_norm %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
osw_ff_hour_norm <- osw_ff_norm %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
shrm_ff_hour_norm <- shrm_ff_norm %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
tb_ff_hour_norm <- tb_ff_norm %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
wrs_ff_hour_norm <- wrs_ff_norm %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
```

```{r}
# Weekdays
bgs_ff_hour_weekday <- bgs_ff %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

chsm_ff_hour_weekday <- chsm_ff %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

crm_ff_hour_weekday <- crm_ff %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

dw_ff_hour_weekday <- dw_ff %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

ern_ff_hour_weekday <- ern_ff %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

ers_ff_hour_weekday <- ers_ff %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

hrm_ff_hour_weekday <- hrm_ff %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

krm_ff_hour_weekday <- krm_ff %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

nrs_ff_hour_weekday <- nrs_ff %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

osw_ff_hour_weekday <- osw_ff %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

shrm_ff_hour_weekday <- shrm_ff %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

tb_ff_hour_weekday <- tb_ff %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

wrs_ff_hour_weekday <- wrs_ff %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
```

```{r}
# Weekdays, normalised
bgs_ff_hour_weekday_norm <- bgs_ff_norm %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

chsm_ff_hour_weekday_norm <- chsm_ff_norm %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

crm_ff_hour_weekday_norm <- crm_ff_norm %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

dw_ff_hour_weekday_norm <- dw_ff_norm %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

ern_ff_hour_weekday_norm <- ern_ff_norm %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

ers_ff_hour_weekday_norm <- ers_ff_norm %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

hrm_ff_hour_weekday_norm <- hrm_ff_norm %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

krm_ff_hour_weekday_norm <- krm_ff_norm %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

nrs_ff_hour_weekday_norm <- nrs_ff_norm %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

osw_ff_hour_weekday_norm <- osw_ff_norm %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

shrm_ff_hour_weekday_norm <- shrm_ff_norm %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

tb_ff_hour_weekday_norm <- tb_ff_norm %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

wrs_ff_hour_weekday_norm <- wrs_ff_norm %>%
  filter(weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
```

```{r}
# Weekends
bgs_ff_hour_weekend <- bgs_ff %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

chsm_ff_hour_weekend <- chsm_ff %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

crm_ff_hour_weekend <- crm_ff %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

dw_ff_hour_weekend <- dw_ff %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

ern_ff_hour_weekend <- ern_ff %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

ers_ff_hour_weekend <- ers_ff %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

hrm_ff_hour_weekend <- hrm_ff %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

krm_ff_hour_weekend <- krm_ff %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

nrs_ff_hour_weekend <- nrs_ff %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

osw_ff_hour_weekend <- osw_ff %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

shrm_ff_hour_weekend <- shrm_ff %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

tb_ff_hour_weekend <- tb_ff %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

wrs_ff_hour_weekend <- wrs_ff %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
```

```{r}
# Weekends, normalised
bgs_ff_hour_weekend_norm <- bgs_ff_norm %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

chsm_ff_hour_weekend_norm <- chsm_ff_norm %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

crm_ff_hour_weekend_norm <- crm_ff_norm %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

dw_ff_hour_weekend_norm <- dw_ff_norm %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

ern_ff_hour_weekend_norm <- ern_ff_norm %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

ers_ff_hour_weekend_norm <- ers_ff_norm %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

hrm_ff_hour_weekend_norm <- hrm_ff_norm %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

krm_ff_hour_weekend_norm <- krm_ff_norm %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

nrs_ff_hour_weekend_norm <- nrs_ff_norm %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

osw_ff_hour_weekend_norm <- osw_ff_norm %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

shrm_ff_hour_weekend_norm <- shrm_ff_norm %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

tb_ff_hour_weekend_norm <- tb_ff_norm %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

wrs_ff_hour_weekend_norm <- wrs_ff_norm %>%
  filter(weekday %in% c("Saturday", "Sunday")) %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
```






## Each days of the week

```{r}
# Monday
bgs_ff_hour_mon <- bgs_ff %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
chsm_ff_hour_mon <- chsm_ff %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
crm_ff_hour_mon <- crm_ff %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
dw_ff_hour_mon <- dw_ff %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ern_ff_hour_mon <- ern_ff %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ers_ff_hour_mon <- ers_ff %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
hrm_ff_hour_mon <- hrm_ff %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
krm_ff_hour_mon <- krm_ff %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
nrs_ff_hour_mon <- nrs_ff %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
osw_ff_hour_mon <- osw_ff %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
shrm_ff_hour_mon <- shrm_ff %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
tb_ff_hour_mon <- tb_ff %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
wrs_ff_hour_mon <- wrs_ff %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

# Tuesday
bgs_ff_hour_tue <- bgs_ff %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
chsm_ff_hour_tue <- chsm_ff %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
crm_ff_hour_tue <- crm_ff %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
dw_ff_hour_tue <- dw_ff %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ern_ff_hour_tue <- ern_ff %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ers_ff_hour_tue <- ers_ff %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
hrm_ff_hour_tue <- hrm_ff %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
krm_ff_hour_tue <- krm_ff %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
nrs_ff_hour_tue <- nrs_ff %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
osw_ff_hour_tue <- osw_ff %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
shrm_ff_hour_tue <- shrm_ff %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
tb_ff_hour_tue <- tb_ff %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
wrs_ff_hour_tue <- wrs_ff %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

# Wednesday
bgs_ff_hour_wed <- bgs_ff %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
chsm_ff_hour_wed <- chsm_ff %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
crm_ff_hour_wed <- crm_ff %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
dw_ff_hour_wed <- dw_ff %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ern_ff_hour_wed <- ern_ff %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ers_ff_hour_wed <- ers_ff %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
hrm_ff_hour_wed <- hrm_ff %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
krm_ff_hour_wed <- krm_ff %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
nrs_ff_hour_wed <- nrs_ff %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
osw_ff_hour_wed <- osw_ff %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
shrm_ff_hour_wed <- shrm_ff %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
tb_ff_hour_wed <- tb_ff %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
wrs_ff_hour_wed <- wrs_ff %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

# Thursday
bgs_ff_hour_thur <- bgs_ff %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
chsm_ff_hour_thur <- chsm_ff %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
crm_ff_hour_thur <- crm_ff %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
dw_ff_hour_thur <- dw_ff %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ern_ff_hour_thur <- ern_ff %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ers_ff_hour_thur <- ers_ff %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
hrm_ff_hour_thur <- hrm_ff %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
krm_ff_hour_thur <- krm_ff %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
nrs_ff_hour_thur <- nrs_ff %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
osw_ff_hour_thur <- osw_ff %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
shrm_ff_hour_thur <- shrm_ff %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
tb_ff_hour_thur <- tb_ff %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
wrs_ff_hour_thur <- wrs_ff %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

# Friday
bgs_ff_hour_fri <- bgs_ff %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
chsm_ff_hour_fri <- chsm_ff %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
crm_ff_hour_fri <- crm_ff %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
dw_ff_hour_fri <- dw_ff %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ern_ff_hour_fri <- ern_ff %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ers_ff_hour_fri <- ers_ff %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
hrm_ff_hour_fri <- hrm_ff %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
krm_ff_hour_fri <- krm_ff %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
nrs_ff_hour_fri <- nrs_ff %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
osw_ff_hour_fri <- osw_ff %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
shrm_ff_hour_fri <- shrm_ff %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
tb_ff_hour_fri <- tb_ff %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
wrs_ff_hour_fri <- wrs_ff %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

# Saturday
bgs_ff_hour_sat <- bgs_ff %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
chsm_ff_hour_sat <- chsm_ff %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
crm_ff_hour_sat <- crm_ff %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
dw_ff_hour_sat <- dw_ff %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ern_ff_hour_sat <- ern_ff %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ers_ff_hour_sat <- ers_ff %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
hrm_ff_hour_sat <- hrm_ff %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
krm_ff_hour_sat <- krm_ff %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
nrs_ff_hour_sat <- nrs_ff %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
osw_ff_hour_sat <- osw_ff %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
shrm_ff_hour_sat <- shrm_ff %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
tb_ff_hour_sat <- tb_ff %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
wrs_ff_hour_sat <- wrs_ff %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))

# Sunday
bgs_ff_hour_sun <- bgs_ff %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
chsm_ff_hour_sun <- chsm_ff %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
crm_ff_hour_sun <- crm_ff %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
dw_ff_hour_sun <- dw_ff %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ern_ff_hour_sun <- ern_ff %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
ers_ff_hour_sun <- ers_ff %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
hrm_ff_hour_sun <- hrm_ff %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
krm_ff_hour_sun <- krm_ff %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
nrs_ff_hour_sun <- nrs_ff %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
osw_ff_hour_sun <- osw_ff %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
shrm_ff_hour_sun <- shrm_ff %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
tb_ff_hour_sun <- tb_ff %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
wrs_ff_hour_sun <- wrs_ff %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(footfall_sum, na.rm = TRUE))
```

```{r}
# Normalised
# Monday
bgs_ff_hour_mon_norm <- bgs_ff_norm %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
chsm_ff_hour_mon_norm <- chsm_ff_norm %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
crm_ff_hour_mon_norm <- crm_ff_norm %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
dw_ff_hour_mon_norm <- dw_ff_norm %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ern_ff_hour_mon_norm <- ern_ff_norm %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ers_ff_hour_mon_norm <- ers_ff_norm %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
hrm_ff_hour_mon_norm <- hrm_ff_norm %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
krm_ff_hour_mon_norm <- krm_ff_norm %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
nrs_ff_hour_mon_norm <- nrs_ff_norm %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
osw_ff_hour_mon_norm <- osw_ff_norm %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
shrm_ff_hour_mon_norm <- shrm_ff_norm %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
tb_ff_hour_mon_norm <- tb_ff_norm %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
wrs_ff_hour_mon_norm <- wrs_ff_norm %>%
  filter(weekday == "Monday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

# Tuesday
bgs_ff_hour_tue_norm <- bgs_ff_norm %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
chsm_ff_hour_tue_norm <- chsm_ff_norm %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
crm_ff_hour_tue_norm <- crm_ff_norm %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
dw_ff_hour_tue_norm <- dw_ff_norm %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ern_ff_hour_tue_norm <- ern_ff_norm %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ers_ff_hour_tue_norm <- ers_ff_norm %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
hrm_ff_hour_tue_norm <- hrm_ff_norm %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
krm_ff_hour_tue_norm <- krm_ff_norm %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
nrs_ff_hour_tue_norm <- nrs_ff_norm %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
osw_ff_hour_tue_norm <- osw_ff_norm %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
shrm_ff_hour_tue_norm <- shrm_ff_norm %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
tb_ff_hour_tue_norm <- tb_ff_norm %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
wrs_ff_hour_tue_norm <- wrs_ff_norm %>%
  filter(weekday == "Tuesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

# Wednesday
bgs_ff_hour_wed_norm <- bgs_ff_norm %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
chsm_ff_hour_wed_norm <- chsm_ff_norm %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
crm_ff_hour_wed_norm <- crm_ff_norm %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
dw_ff_hour_wed_norm <- dw_ff_norm %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ern_ff_hour_wed_norm <- ern_ff_norm %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ers_ff_hour_wed_norm <- ers_ff_norm %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
hrm_ff_hour_wed_norm <- hrm_ff_norm %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
krm_ff_hour_wed_norm <- krm_ff_norm %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
nrs_ff_hour_wed_norm <- nrs_ff_norm %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
osw_ff_hour_wed_norm <- osw_ff_norm %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
shrm_ff_hour_wed_norm <- shrm_ff_norm %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
tb_ff_hour_wed_norm <- tb_ff_norm %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
wrs_ff_hour_wed_norm <- wrs_ff_norm %>%
  filter(weekday == "Wednesday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

# Thursday
bgs_ff_hour_thur_norm <- bgs_ff_norm %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
chsm_ff_hour_thur_norm <- chsm_ff_norm %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
crm_ff_hour_thur_norm <- crm_ff_norm %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
dw_ff_hour_thur_norm <- dw_ff_norm %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ern_ff_hour_thur_norm <- ern_ff_norm %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ers_ff_hour_thur_norm <- ers_ff_norm %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
hrm_ff_hour_thur_norm <- hrm_ff_norm %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
krm_ff_hour_thur_norm <- krm_ff_norm %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
nrs_ff_hour_thur_norm <- nrs_ff_norm %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
osw_ff_hour_thur_norm <- osw_ff_norm %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
shrm_ff_hour_thur_norm <- shrm_ff_norm %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
tb_ff_hour_thur_norm <- tb_ff_norm %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
wrs_ff_hour_thur_norm <- wrs_ff_norm %>%
  filter(weekday == "Thursday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

# Friday
bgs_ff_hour_fri_norm <- bgs_ff_norm %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
chsm_ff_hour_fri_norm <- chsm_ff_norm  %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
crm_ff_hour_fri_norm <- crm_ff_norm %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
dw_ff_hour_fri_norm <- dw_ff_norm %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ern_ff_hour_fri_norm <- ern_ff_norm %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ers_ff_hour_fri_norm <- ers_ff_norm %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
hrm_ff_hour_fri_norm <- hrm_ff_norm %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
krm_ff_hour_fri_norm <- krm_ff_norm %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
nrs_ff_hour_fri_norm <- nrs_ff_norm %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
osw_ff_hour_fri_norm <- osw_ff_norm %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
shrm_ff_hour_fri_norm <- shrm_ff_norm %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
tb_ff_hour_fri_norm <- tb_ff_norm %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
wrs_ff_hour_fri_norm <- wrs_ff_norm %>%
  filter(weekday == "Friday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

# Saturday
bgs_ff_hour_sat_norm <- bgs_ff_norm %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
chsm_ff_hour_sat_norm <- chsm_ff_norm %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
crm_ff_hour_sat_norm <- crm_ff_norm %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
dw_ff_hour_sat_norm <- dw_ff_norm %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ern_ff_hour_sat_norm <- ern_ff_norm %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ers_ff_hour_sat_norm <- ers_ff_norm %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
hrm_ff_hour_sat_norm <- hrm_ff_norm %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
krm_ff_hour_sat_norm <- krm_ff_norm %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
nrs_ff_hour_sat_norm <- nrs_ff_norm %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
osw_ff_hour_sat_norm <- osw_ff_norm %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
shrm_ff_hour_sat_norm <- shrm_ff_norm %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
tb_ff_hour_sat_norm <- tb_ff_norm %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
wrs_ff_hour_sat_norm <- wrs_ff_norm %>%
  filter(weekday == "Saturday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))

# Sunday
bgs_ff_hour_sun_norm <- bgs_ff_norm %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
chsm_ff_hour_sun_norm <- chsm_ff_norm %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
crm_ff_hour_sun_norm <- crm_ff_norm %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
dw_ff_hour_sun_norm <- dw_ff_norm %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ern_ff_hour_sun_norm <- ern_ff_norm %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
ers_ff_hour_sun_norm <- ers_ff_norm %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
hrm_ff_hour_sun_norm <- hrm_ff_norm %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
krm_ff_hour_sun_norm <- krm_ff_norm %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
nrs_ff_hour_sun_norm <- nrs_ff_norm %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
osw_ff_hour_sun_norm <- osw_ff_norm %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
shrm_ff_hour_sun_norm <- shrm_ff_norm %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
tb_ff_hour_sun_norm <- tb_ff_norm %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
wrs_ff_hour_sun_norm <- wrs_ff_norm %>%
  filter(weekday == "Sunday") %>%
  group_by(time) %>%
  summarise(avg_footfall = mean(normalised_footfall, na.rm = TRUE))
```

#### Export csv

```{r}
# mon
write.csv(bgs_ff_hour_mon, file = "bgs_ff_hours_mon.csv", row.names = TRUE)
write.csv(chsm_ff_hour_mon, file = "chsm_ff_hours_mon.csv", row.names = TRUE)
write.csv(crm_ff_hour_mon, file = "crm_ff_hours_mon.csv", row.names = TRUE)
write.csv(dw_ff_hour_mon, file = "dw_ff_hours_mon.csv", row.names = TRUE)
write.csv(ern_ff_hour_mon, file = "ern_ff_hours_mon.csv", row.names = TRUE)
write.csv(ers_ff_hour_mon, file = "ers_ff_hours_mon.csv", row.names = TRUE)
write.csv(hrm_ff_hour_mon, file = "hrm_ff_hours_mon.csv", row.names = TRUE)
write.csv(krm_ff_hour_mon, file = "krm_ff_hours_mon.csv", row.names = TRUE)
write.csv(nrs_ff_hour_mon, file = "nrs_ff_hours_mon.csv", row.names = TRUE)
write.csv(osw_ff_hour_mon, file = "osw_ff_hours_mon.csv", row.names = TRUE)
write.csv(shrm_ff_hour_mon, file = "shrm_ff_hours_mon.csv", row.names = TRUE)
write.csv(tb_ff_hour_mon, file = "tb_ff_hours_mon.csv", row.names = TRUE)
write.csv(wrs_ff_hour_mon, file = "wrs_ff_hours_mon.csv", row.names = TRUE)

# sat
write.csv(bgs_ff_hour_sat, file = "bgs_ff_hours_sat.csv", row.names = TRUE)
write.csv(chsm_ff_hour_sat, file = "chsm_ff_hours_sat.csv", row.names = TRUE)
write.csv(crm_ff_hour_sat, file = "crm_ff_hours_sat.csv", row.names = TRUE)
write.csv(dw_ff_hour_sat, file = "dw_ff_hours_sat.csv", row.names = TRUE)
write.csv(ern_ff_hour_sat, file = "ern_ff_hours_sat.csv", row.names = TRUE)
write.csv(ers_ff_hour_sat, file = "ers_ff_hours_sat.csv", row.names = TRUE)
write.csv(hrm_ff_hour_sat, file = "hrm_ff_hours_sat.csv", row.names = TRUE)
write.csv(krm_ff_hour_sat, file = "krm_ff_hours_sat.csv", row.names = TRUE)
write.csv(nrs_ff_hour_sat, file = "nrs_ff_hours_sat.csv", row.names = TRUE)
write.csv(osw_ff_hour_sat, file = "osw_ff_hours_sat.csv", row.names = TRUE)
write.csv(shrm_ff_hour_sat, file = "shrm_ff_hours_sat.csv", row.names = TRUE)
write.csv(tb_ff_hour_sat, file = "tb_ff_hours_sat.csv", row.names = TRUE)
write.csv(wrs_ff_hour_sat, file = "wrs_ff_hours_sat.csv", row.names = TRUE)

# tue
write.csv(bgs_ff_hour_tue, file = "bgs_ff_hour_tue.csv", row.names = TRUE)
write.csv(chsm_ff_hour_tue, file = "chsm_ff_hour_tue.csv", row.names = TRUE)
write.csv(crm_ff_hour_tue, file = "crm_ff_hour_tue.csv", row.names = TRUE)
write.csv(dw_ff_hour_tue, file = "dw_ff_hour_tue.csv", row.names = TRUE)
write.csv(ern_ff_hour_tue, file = "ern_ff_hour_tue.csv", row.names = TRUE)
write.csv(ers_ff_hour_tue, file = "ers_ff_hour_tue.csv", row.names = TRUE)
write.csv(hrm_ff_hour_tue, file = "hrm_ff_hour_tue.csv", row.names = TRUE)
write.csv(krm_ff_hour_tue, file = "krm_ff_hour_tue.csv", row.names = TRUE)
write.csv(nrs_ff_hour_tue, file = "nrs_ff_hour_tue.csv", row.names = TRUE)
write.csv(osw_ff_hour_tue, file = "osw_ff_hour_tue.csv", row.names = TRUE)
write.csv(shrm_ff_hour_tue, file = "shrm_ff_hour_tue.csv", row.names = TRUE)
write.csv(tb_ff_hour_tue, file = "tb_ff_hour_tue.csv", row.names = TRUE)
write.csv(wrs_ff_hour_tue, file = "wrs_ff_hour_tue.csv", row.names = TRUE)
```

```{r}
# wed
write.csv(bgs_ff_hour_wed, file = "bgs_ff_hour_wed.csv", row.names = TRUE)
write.csv(chsm_ff_hour_wed, file = "chsm_ff_hour_wed.csv", row.names = TRUE)
write.csv(crm_ff_hour_wed, file = "crm_ff_hour_wed.csv", row.names = TRUE)
write.csv(dw_ff_hour_wed, file = "dw_ff_hour_wed.csv", row.names = TRUE)
write.csv(ern_ff_hour_wed, file = "ern_ff_hour_wed.csv", row.names = TRUE)
write.csv(ers_ff_hour_wed, file = "ers_ff_hour_wed.csv", row.names = TRUE)
write.csv(hrm_ff_hour_wed, file = "hrm_ff_hour_wed.csv", row.names = TRUE)
write.csv(krm_ff_hour_wed, file = "krm_ff_hour_wed.csv", row.names = TRUE)
write.csv(nrs_ff_hour_wed, file = "nrs_ff_hour_wed.csv", row.names = TRUE)
write.csv(osw_ff_hour_wed, file = "osw_ff_hour_wed.csv", row.names = TRUE)
write.csv(shrm_ff_hour_wed, file = "shrm_ff_hour_wed.csv", row.names = TRUE)
write.csv(tb_ff_hour_wed, file = "tb_ff_hour_wed.csv", row.names = TRUE)
write.csv(wrs_ff_hour_wed, file = "wrs_ff_hour_wed.csv", row.names = TRUE)
```

```{r}
# thurs
write.csv(bgs_ff_hour_thur, file = "bgs_ff_hour_thur.csv", row.names = TRUE)
write.csv(chsm_ff_hour_thur, file = "chsm_ff_hour_thur.csv", row.names = TRUE)
write.csv(crm_ff_hour_thur, file = "crm_ff_hour_thur.csv", row.names = TRUE)
write.csv(dw_ff_hour_thur, file = "dw_ff_hour_thur.csv", row.names = TRUE)
write.csv(ern_ff_hour_thur, file = "ern_ff_hour_thur.csv", row.names = TRUE)
write.csv(ers_ff_hour_thur, file = "ers_ff_hour_thur.csv", row.names = TRUE)
write.csv(hrm_ff_hour_thur, file = "hrm_ff_hour_thur.csv", row.names = TRUE)
write.csv(krm_ff_hour_thur, file = "krm_ff_hour_thur.csv", row.names = TRUE)
write.csv(nrs_ff_hour_thur, file = "nrs_ff_hour_thur.csv", row.names = TRUE)
write.csv(osw_ff_hour_thur, file = "osw_ff_hour_thur.csv", row.names = TRUE)
write.csv(shrm_ff_hour_thur, file = "shrm_ff_hour_thur.csv", row.names = TRUE)
write.csv(tb_ff_hour_thur, file = "tb_ff_hour_thur.csv", row.names = TRUE)
write.csv(wrs_ff_hour_thur, file = "wrs_ff_hour_thur.csv", row.names = TRUE)
```

```{r}
# fri
write.csv(bgs_ff_hour_fri, file = "bgs_ff_hour_fri.csv", row.names = TRUE)
write.csv(chsm_ff_hour_fri, file = "chsm_ff_hour_fri.csv", row.names = TRUE)
write.csv(crm_ff_hour_fri, file = "crm_ff_hour_fri.csv", row.names = TRUE)
write.csv(dw_ff_hour_fri, file = "dw_ff_hour_fri.csv", row.names = TRUE)
write.csv(ern_ff_hour_fri, file = "ern_ff_hour_fri.csv", row.names = TRUE)
write.csv(ers_ff_hour_fri, file = "ers_ff_hour_fri.csv", row.names = TRUE)
write.csv(hrm_ff_hour_fri, file = "hrm_ff_hour_fri.csv", row.names = TRUE)
write.csv(krm_ff_hour_fri, file = "krm_ff_hour_fri.csv", row.names = TRUE)
write.csv(nrs_ff_hour_fri, file = "nrs_ff_hour_fri.csv", row.names = TRUE)
write.csv(osw_ff_hour_fri, file = "osw_ff_hour_fri.csv", row.names = TRUE)
write.csv(shrm_ff_hour_fri, file = "shrm_ff_hour_fri.csv", row.names = TRUE)
write.csv(tb_ff_hour_fri, file = "tb_ff_hour_fri.csv", row.names = TRUE)
write.csv(wrs_ff_hour_fri, file = "wrs_ff_hour_fri.csv", row.names = TRUE)
```

```{r}
# sun
write.csv(bgs_ff_hour_sun, file = "bgs_ff_hour_sun.csv", row.names = TRUE)
write.csv(chsm_ff_hour_sun, file = "chsm_ff_hour_sun.csv", row.names = TRUE)
write.csv(crm_ff_hour_sun, file = "crm_ff_hour_sun.csv", row.names = TRUE)
write.csv(dw_ff_hour_sun, file = "dw_ff_hour_sun.csv", row.names = TRUE)
write.csv(ern_ff_hour_sun, file = "ern_ff_hour_sun.csv", row.names = TRUE)
write.csv(ers_ff_hour_sun, file = "ers_ff_hour_sun.csv", row.names = TRUE)
write.csv(hrm_ff_hour_sun, file = "hrm_ff_hour_sun.csv", row.names = TRUE)
write.csv(krm_ff_hour_sun, file = "krm_ff_hour_sun.csv", row.names = TRUE)
write.csv(nrs_ff_hour_sun, file = "nrs_ff_hour_sun.csv", row.names = TRUE)
write.csv(osw_ff_hour_sun, file = "osw_ff_hour_sun.csv", row.names = TRUE)
write.csv(shrm_ff_hour_sun, file = "shrm_ff_hour_sun.csv", row.names = TRUE)
write.csv(tb_ff_hour_sun, file = "tb_ff_hour_sun.csv", row.names = TRUE)
write.csv(wrs_ff_hour_sun, file = "wrs_ff_hour_sun.csv", row.names = TRUE)
```

### Monday footfall distribution timeseries

```{r}
ggplot(bgs_ff_hour_mon, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Bruce Grove South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(bgs_ff_hour_mon_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Bruce Grove South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(chsm_ff_hour_mon, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham High Street Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(chsm_ff_hour_mon_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham High Street Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(crm_ff_hour_mon, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(crm_ff_hour_mon_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(dw_ff_hour_mon, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Daneland Walk", x = "Time", y = "Footfall count")
```

```{r}
ggplot(dw_ff_hour_mon_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Daneland Walk", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ern_ff_hour_mon, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road North", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ern_ff_hour_mon_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road North", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ers_ff_hour_mon, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ers_ff_hour_mon_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(hrm_ff_hour_mon, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(hrm_ff_hour_mon_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(krm_ff_hour_mon, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Kennington Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(krm_ff_hour_mon_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Kennington Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(nrs_ff_hour_mon, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Norwood Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(nrs_ff_hour_mon_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Norwood Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(osw_ff_hour_mon, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Oxford Street West", x = "Time", y = "Footfall count")
```

```{r}
ggplot(osw_ff_hour_mon_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Oxford Street West", x = "Time", y = "Footfall count")
```

```{r}
ggplot(shrm_ff_hour_mon, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Streatham High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(shrm_ff_hour_mon_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Streatham High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(tb_ff_hour_mon, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "The Broadway", x = "Time", y = "Footfall count")
```

```{r}
ggplot(tb_ff_hour_mon_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "The Broadway", x = "Time", y = "Footfall count")
```

```{r}
ggplot(wrs_ff_hour_mon, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Wandsworth Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(wrs_ff_hour_mon_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Wandsworth Road South", x = "Time", y = "Footfall count")
```

### Tuesday

```{r}
ggplot(bgs_ff_hour_tue, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Bruce Grove South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(bgs_ff_hour_tue_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Bruce Grove South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(chsm_ff_hour_tue, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham High Street Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(chsm_ff_hour_tue_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham High Street Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(crm_ff_hour_tue, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(crm_ff_hour_tue_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(dw_ff_hour_tue, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Daneland Walk", x = "Time", y = "Footfall count")
```

```{r}
ggplot(dw_ff_hour_tue_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Daneland Walk", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ern_ff_hour_tue, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road North", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ern_ff_hour_tue_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road North", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ers_ff_hour_tue, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ers_ff_hour_tue_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(hrm_ff_hour_tue, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(hrm_ff_hour_tue_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(krm_ff_hour_tue, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Kennington Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(krm_ff_hour_tue_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Kennington Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(nrs_ff_hour_tue, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Norwood Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(nrs_ff_hour_tue_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Norwood Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(osw_ff_hour_tue, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Oxford Street West", x = "Time", y = "Footfall count")
```

```{r}
ggplot(osw_ff_hour_tue_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Oxford Street West", x = "Time", y = "Footfall count")
```

```{r}
ggplot(shrm_ff_hour_tue, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Streatham High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(shrm_ff_hour_tue_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Streatham High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(tb_ff_hour_tue, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "The Broadway", x = "Time", y = "Footfall count")
```

```{r}
ggplot(tb_ff_hour_tue_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "The Broadway", x = "Time", y = "Footfall count")
```

```{r}
ggplot(wrs_ff_hour_tue, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Wandsworth Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(wrs_ff_hour_tue_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Wandsworth Road South", x = "Time", y = "Footfall count")
```

### Wednesday

```{r}
ggplot(bgs_ff_hour_wed, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Bruce Grove South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(bgs_ff_hour_wed_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Bruce Grove South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(chsm_ff_hour_wed, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham High Street Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(chsm_ff_hour_wed_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham High Street Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(crm_ff_hour_wed, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(crm_ff_hour_wed_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(dw_ff_hour_wed, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Daneland Walk", x = "Time", y = "Footfall count")
```

```{r}
ggplot(dw_ff_hour_wed_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Daneland Walk", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ern_ff_hour_wed, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road North", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ern_ff_hour_wed_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road North", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ers_ff_hour_wed, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ers_ff_hour_wed_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(hrm_ff_hour_wed, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(hrm_ff_hour_wed_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(krm_ff_hour_wed, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Kennington Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(krm_ff_hour_wed_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Kennington Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(nrs_ff_hour_wed, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Norwood Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(nrs_ff_hour_wed_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Norwood Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(osw_ff_hour_wed, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Oxford Street West", x = "Time", y = "Footfall xount")
```

```{r}
ggplot(osw_ff_hour_wed_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Oxford Street West", x = "Time", y = "Footfall xount")
```

```{r}
ggplot(shrm_ff_hour_wed, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Streatham High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(shrm_ff_hour_wed_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Streatham High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(tb_ff_hour_wed, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "The Broadway", x = "Time", y = "Footfall count")
```

```{r}
ggplot(tb_ff_hour_wed_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "The Broadway", x = "Time", y = "Footfall count")
```

```{r}
ggplot(wrs_ff_hour_wed, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Wandsworth Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(wrs_ff_hour_wed_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Wandsworth Road South", x = "Time", y = "Footfall count")
```

### Thursday

```{r}
ggplot(bgs_ff_hour_thur, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Bruce Grove South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(bgs_ff_hour_thur_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Bruce Grove South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(chsm_ff_hour_thur, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham High Street Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(chsm_ff_hour_thur_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham High Street Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(crm_ff_hour_thur, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(crm_ff_hour_thur_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(dw_ff_hour_thur, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Daneland Walk", x = "Time", y = "Footfall count")
```

```{r}
ggplot(dw_ff_hour_thur_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Daneland Walk", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ern_ff_hour_thur, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road North", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ern_ff_hour_thur_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road North", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ers_ff_hour_thur, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ers_ff_hour_thur_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(hrm_ff_hour_thur, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(hrm_ff_hour_thur_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(krm_ff_hour_thur, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Kennington Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(krm_ff_hour_thur_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Kennington Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(nrs_ff_hour_thur, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Norwood Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(nrs_ff_hour_thur_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Norwood Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(osw_ff_hour_thur, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Oxford Street West", x = "Time", y = "Footfall count")
```

```{r}
ggplot(osw_ff_hour_thur_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Oxford Street West", x = "Time", y = "Footfall count")
```

```{r}
ggplot(shrm_ff_hour_thur, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Streatham High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(shrm_ff_hour_thur_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Streatham High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(tb_ff_hour_thur, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "The Broadway", x = "Time", y = "Footfall count")
```

```{r}
ggplot(tb_ff_hour_thur_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "The Broadway", x = "Time", y = "Footfall count")
```

```{r}
ggplot(wrs_ff_hour_thur, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Wandsworth Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(wrs_ff_hour_thur_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Wandsworth Road South", x = "Time", y = "Footfall count")
```

### Friday

```{r}
ggplot(bgs_ff_hour_fri, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Bruce Grove South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(bgs_ff_hour_fri_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Bruce Grove South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(chsm_ff_hour_fri, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham High Street Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(chsm_ff_hour_fri_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham High Street Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(crm_ff_hour_fri, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(crm_ff_hour_fri_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(dw_ff_hour_fri, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Daneland Walk", x = "Time", y = "Footfall count")
```

```{r}
ggplot(dw_ff_hour_fri_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Daneland Walk", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ern_ff_hour_fri, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road North", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ern_ff_hour_fri_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road North", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ers_ff_hour_fri, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ers_ff_hour_fri_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(hrm_ff_hour_fri, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(hrm_ff_hour_fri_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(krm_ff_hour_fri, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Kennington Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(krm_ff_hour_fri_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Kennington Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(nrs_ff_hour_fri, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Norwood Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(nrs_ff_hour_fri_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Norwood Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(osw_ff_hour_fri, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Oxford Street West", x = "Time", y = "Footfall count")
```

```{r}
ggplot(osw_ff_hour_fri_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Oxford Street West", x = "Time", y = "Footfall count")
```

```{r}
ggplot(shrm_ff_hour_fri, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Streatham High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(shrm_ff_hour_fri_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Streatham High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(tb_ff_hour_fri, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "The Broadway", x = "Time", y = "Footfall count")
```

```{r}
ggplot(tb_ff_hour_fri_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "The Broadway", x = "Time", y = "Footfall count")
```

```{r}
ggplot(wrs_ff_hour_fri, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Wandsworth Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(wrs_ff_hour_fri_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Wandsworth Road South", x = "Time", y = "Footfall count")
```

### Saturday

```{r}
ggplot(bgs_ff_hour_sat, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Bruce Grove South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(bgs_ff_hour_sat_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Bruce Grove South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(chsm_ff_hour_sat, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham High Street Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(chsm_ff_hour_sat_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham High Street Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(crm_ff_hour_sat, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(crm_ff_hour_sat_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(dw_ff_hour_sat, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Daneland Walk", x = "Time", y = "Footfall count")
```

```{r}
ggplot(dw_ff_hour_sat_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Daneland Walk", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ern_ff_hour_sat, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road North", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ern_ff_hour_sat_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road North", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ers_ff_hour_sat, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ers_ff_hour_sat_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(hrm_ff_hour_sat, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(hrm_ff_hour_sat_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(krm_ff_hour_sat, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Kennington Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(krm_ff_hour_sat_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Kennington Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(nrs_ff_hour_sat, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Norwood Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(nrs_ff_hour_sat_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Norwood Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(osw_ff_hour_sat, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Oxford Street West", x = "Time", y = "Footfall count")
```

```{r}
ggplot(osw_ff_hour_sat_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Oxford Street West", x = "Time", y = "Footfall count")
```

```{r}
ggplot(shrm_ff_hour_sat, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Streatham High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(shrm_ff_hour_sat_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Streatham High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(tb_ff_hour_sat, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "The Broadway", x = "Time", y = "Footfall count")
```

```{r}
ggplot(tb_ff_hour_sat_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "The Broadway", x = "Time", y = "Footfall count")
```

```{r}
ggplot(wrs_ff_hour_sat, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Wandsworth Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(wrs_ff_hour_sat_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Wandsworth Road South", x = "Time", y = "Footfall count")
```

### Sunday

```{r}
ggplot(bgs_ff_hour_sun, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Bruce Grove South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(bgs_ff_hour_sun_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Bruce Grove South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(chsm_ff_hour_sun, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham High Street Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(chsm_ff_hour_sun_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham High Street Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(crm_ff_hour_sun, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(crm_ff_hour_sun_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Clapham Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(dw_ff_hour_sun, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Daneland Walk", x = "Time", y = "Footfall count")
```

```{r}
ggplot(dw_ff_hour_sun_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Daneland Walk", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ern_ff_hour_sun, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road North", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ern_ff_hour_sun_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road North", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ers_ff_hour_sun, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(ers_ff_hour_sun_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Edgware Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(hrm_ff_hour_sun, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(hrm_ff_hour_sun_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(krm_ff_hour_sun, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Kennington Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(krm_ff_hour_sun_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Kennington Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(nrs_ff_hour_sun, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Norwood Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(nrs_ff_hour_sun_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Norwood Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(osw_ff_hour_sun, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Oxford Street West", x = "Time", y = "Footfall count")
```

```{r}
ggplot(osw_ff_hour_sun_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Oxford Street West", x = "Time", y = "Footfall count")
```

```{r}
ggplot(shrm_ff_hour_sun, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Streatham High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(shrm_ff_hour_sun_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Streatham High Road Middle", x = "Time", y = "Footfall count")
```

```{r}
ggplot(tb_ff_hour_sun, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "The Broadway", x = "Time", y = "Footfall count")
```

```{r}
ggplot(tb_ff_hour_sun_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "The Broadway", x = "Time", y = "Footfall count")
```

```{r}
ggplot(wrs_ff_hour_sun, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Wandsworth Road South", x = "Time", y = "Footfall count")
```

```{r}
ggplot(wrs_ff_hour_sun_norm, aes(x = time, y = avg_footfall)) +
  geom_line(size = 0.5) +  # Use lines to connect data points
  geom_point(size = 2) +  # Optionally add points to the lines
  labs(title = "Wandsworth Road South", x = "Time", y = "Footfall count")
```

# Ready for spatial autocorrelation

-   Average footfall in each day of the week
-   Average footfall across the week, whole week/ weekdays/ weekend
-   Average footfall in the morning, afternoon, night, and midnight --\> whole week/ weekdays/ weekends

## Average footfall in each day of the week

```{r}
# Monday
bgs_ff_hour_mon$street <- "Bruce Grove South"
chsm_ff_hour_mon$street <- "Clapham High Street Middle"
crm_ff_hour_mon$street <- "Clapham Road Middle"
dw_ff_hour_mon$street <- "Daneland Walk"
ern_ff_hour_mon$street <- "Edgware Road North"
ers_ff_hour_mon$street <- "Edgware Road South"
hrm_ff_hour_mon$street <- "High Road Middle"
krm_ff_hour_mon$street <- "Kennington Road Middle"
nrs_ff_hour_mon$street <- "Norwood Road South"
osw_ff_hour_mon$street <- "Oxford Street West"
shrm_ff_hour_mon$street <- "Streatham High Road Middle"
tb_ff_hour_mon$street <- "The Broadway"
wrs_ff_hour_mon$street <- "Wandsworth Road South"
# Tuesday
bgs_ff_hour_tue$street <- "Bruce Grove South"
chsm_ff_hour_tue$street <- "Clapham High Street Middle"
crm_ff_hour_tue$street <- "Clapham Road Middle"
dw_ff_hour_tue$street <- "Daneland Walk"
ern_ff_hour_tue$street <- "Edgware Road North"
ers_ff_hour_tue$street <- "Edgware Road South"
hrm_ff_hour_tue$street <- "High Road Middle"
krm_ff_hour_tue$street <- "Kennington Road Middle"
nrs_ff_hour_tue$street <- "Norwood Road South"
osw_ff_hour_tue$street <- "Oxford Street West"
shrm_ff_hour_tue$street <- "Streatham High Road Middle"
tb_ff_hour_tue$street <- "The Broadway"
wrs_ff_hour_tue$street <- "Wandsworth Road South"
# Wednesday
bgs_ff_hour_wed$street <- "Bruce Grove South"
chsm_ff_hour_wed$street <- "Clapham High Street Middle"
crm_ff_hour_wed$street <- "Clapham Road Middle"
dw_ff_hour_wed$street <- "Daneland Walk"
ern_ff_hour_wed$street <- "Edgware Road North"
ers_ff_hour_wed$street <- "Edgware Road South"
hrm_ff_hour_wed$street <- "High Road Middle"
krm_ff_hour_wed$street <- "Kennington Road Middle"
nrs_ff_hour_wed$street <- "Norwood Road South"
osw_ff_hour_wed$street <- "Oxford Street West"
shrm_ff_hour_wed$street <- "Streatham High Road Middle"
tb_ff_hour_wed$street <- "The Broadway"
wrs_ff_hour_wed$street <- "Wandsworth Road South"
# Thursday
bgs_ff_hour_thur$street <- "Bruce Grove South"
chsm_ff_hour_thur$street <- "Clapham High Street Middle"
crm_ff_hour_thur$street <- "Clapham Road Middle"
dw_ff_hour_thur$street <- "Daneland Walk"
ern_ff_hour_thur$street <- "Edgware Road North"
ers_ff_hour_thur$street <- "Edgware Road South"
hrm_ff_hour_thur$street <- "High Road Middle"
krm_ff_hour_thur$street <- "Kennington Road Middle"
nrs_ff_hour_thur$street <- "Norwood Road South"
osw_ff_hour_thur$street <- "Oxford Street West"
shrm_ff_hour_thur$street <- "Streatham High Road Middle"
tb_ff_hour_thur$street <- "The Broadway"
wrs_ff_hour_thur$street <- "Wandsworth Road South"
# Friday
bgs_ff_hour_fri$street <- "Bruce Grove South"
chsm_ff_hour_fri$street <- "Clapham High Street Middle"
crm_ff_hour_fri$street <- "Clapham Road Middle"
dw_ff_hour_fri$street <- "Daneland Walk"
ern_ff_hour_fri$street <- "Edgware Road North"
ers_ff_hour_fri$street <- "Edgware Road South"
hrm_ff_hour_fri$street <- "High Road Middle"
krm_ff_hour_fri$street <- "Kennington Road Middle"
nrs_ff_hour_fri$street <- "Norwood Road South"
osw_ff_hour_fri$street <- "Oxford Street West"
shrm_ff_hour_fri$street <- "Streatham High Road Middle"
tb_ff_hour_fri$street <- "The Broadway"
wrs_ff_hour_fri$street <- "Wandsworth Road South"
# Saturday
bgs_ff_hour_sat$street <- "Bruce Grove South"
chsm_ff_hour_sat$street <- "Clapham High Street Middle"
crm_ff_hour_sat$street <- "Clapham Road Middle"
dw_ff_hour_sat$street <- "Daneland Walk"
ern_ff_hour_sat$street <- "Edgware Road North"
ers_ff_hour_sat$street <- "Edgware Road South"
hrm_ff_hour_sat$street <- "High Road Middle"
krm_ff_hour_sat$street <- "Kennington Road Middle"
nrs_ff_hour_sat$street <- "Norwood Road South"
osw_ff_hour_sat$street <- "Oxford Street West"
shrm_ff_hour_sat$street <- "Streatham High Road Middle"
tb_ff_hour_sat$street <- "The Broadway"
wrs_ff_hour_sat$street <- "Wandsworth Road South"
# Sunday
bgs_ff_hour_sun$street <- "Bruce Grove South"
chsm_ff_hour_sun$street <- "Clapham High Street Middle"
crm_ff_hour_sun$street <- "Clapham Road Middle"
dw_ff_hour_sun$street <- "Daneland Walk"
ern_ff_hour_sun$street <- "Edgware Road North"
ers_ff_hour_sun$street <- "Edgware Road South"
hrm_ff_hour_sun$street <- "High Road Middle"
krm_ff_hour_sun$street <- "Kennington Road Middle"
nrs_ff_hour_sun$street <- "Norwood Road South"
osw_ff_hour_sun$street <- "Oxford Street West"
shrm_ff_hour_sun$street <- "Streatham High Road Middle"
tb_ff_hour_sun$street <- "The Broadway"
wrs_ff_hour_sun$street <- "Wandsworth Road South"

mean(bgs_ff_hour_mon$avg_footfall)
mean(chsm_ff_hour_mon$avg_footfall)
mean(crm_ff_hour_mon$avg_footfall)
mean(dw_ff_hour_mon$avg_footfall)
mean(ern_ff_hour_mon$avg_footfall)
mean(ers_ff_hour_mon$avg_footfall)
mean(hrm_ff_hour_mon$avg_footfall)
mean(krm_ff_hour_mon$avg_footfall)
mean(nrs_ff_hour_mon$avg_footfall)
mean(osw_ff_hour_mon$avg_footfall)
mean(shrm_ff_hour_mon$avg_footfall)
mean(tb_ff_hour_mon$avg_footfall)
mean(wrs_ff_hour_mon$avg_footfall)

mean(bgs_ff_hour_tue$avg_footfall)
mean(chsm_ff_hour_tue$avg_footfall)
mean(crm_ff_hour_tue$avg_footfall)
mean(dw_ff_hour_tue$avg_footfall)
mean(ern_ff_hour_tue$avg_footfall)
mean(ers_ff_hour_tue$avg_footfall)
mean(hrm_ff_hour_tue$avg_footfall)
mean(krm_ff_hour_tue$avg_footfall)
mean(nrs_ff_hour_tue$avg_footfall)
mean(osw_ff_hour_tue$avg_footfall)
mean(shrm_ff_hour_tue$avg_footfall)
mean(tb_ff_hour_tue$avg_footfall)
mean(wrs_ff_hour_tue$avg_footfall)

mean(bgs_ff_hour_wed$avg_footfall)
mean(chsm_ff_hour_wed$avg_footfall)
mean(crm_ff_hour_wed$avg_footfall)
mean(dw_ff_hour_wed$avg_footfall)
mean(ern_ff_hour_wed$avg_footfall)
mean(ers_ff_hour_wed$avg_footfall)
mean(hrm_ff_hour_wed$avg_footfall)
mean(krm_ff_hour_wed$avg_footfall)
mean(nrs_ff_hour_wed$avg_footfall)
mean(osw_ff_hour_wed$avg_footfall)
mean(shrm_ff_hour_wed$avg_footfall)
mean(tb_ff_hour_wed$avg_footfall)
mean(wrs_ff_hour_wed$avg_footfall)

mean(bgs_ff_hour_thur$avg_footfall)
mean(chsm_ff_hour_thur$avg_footfall)
mean(crm_ff_hour_thur$avg_footfall)
mean(dw_ff_hour_thur$avg_footfall)
mean(ern_ff_hour_thur$avg_footfall)
mean(ers_ff_hour_thur$avg_footfall)
mean(hrm_ff_hour_thur$avg_footfall)
mean(krm_ff_hour_thur$avg_footfall)
mean(nrs_ff_hour_thur$avg_footfall)
mean(osw_ff_hour_thur$avg_footfall)
mean(shrm_ff_hour_thur$avg_footfall)
mean(tb_ff_hour_thur$avg_footfall)
mean(wrs_ff_hour_thur$avg_footfall)

mean(bgs_ff_hour_fri$avg_footfall)
mean(chsm_ff_hour_fri$avg_footfall)
mean(crm_ff_hour_fri$avg_footfall)
mean(dw_ff_hour_fri$avg_footfall)
mean(ern_ff_hour_fri$avg_footfall)
mean(ers_ff_hour_fri$avg_footfall)
mean(hrm_ff_hour_fri$avg_footfall)
mean(krm_ff_hour_fri$avg_footfall)
mean(nrs_ff_hour_fri$avg_footfall)
mean(osw_ff_hour_fri$avg_footfall)
mean(shrm_ff_hour_fri$avg_footfall)
mean(tb_ff_hour_fri$avg_footfall)
mean(wrs_ff_hour_fri$avg_footfall)

mean(bgs_ff_hour_sat$avg_footfall)
mean(chsm_ff_hour_sat$avg_footfall)
mean(crm_ff_hour_sat$avg_footfall)
mean(dw_ff_hour_sat$avg_footfall)
mean(ern_ff_hour_sat$avg_footfall)
mean(ers_ff_hour_sat$avg_footfall)
mean(hrm_ff_hour_sat$avg_footfall)
mean(krm_ff_hour_sat$avg_footfall)
mean(nrs_ff_hour_sat$avg_footfall)
mean(osw_ff_hour_sat$avg_footfall)
mean(shrm_ff_hour_sat$avg_footfall)
mean(tb_ff_hour_sat$avg_footfall)
mean(wrs_ff_hour_sat$avg_footfall)

mean(bgs_ff_hour_sun$avg_footfall)
mean(chsm_ff_hour_sun$avg_footfall)
mean(crm_ff_hour_sun$avg_footfall)
mean(dw_ff_hour_sun$avg_footfall)
mean(ern_ff_hour_sun$avg_footfall)
mean(ers_ff_hour_sun$avg_footfall)
mean(hrm_ff_hour_sun$avg_footfall)
mean(krm_ff_hour_sun$avg_footfall)
mean(nrs_ff_hour_sun$avg_footfall)
mean(osw_ff_hour_sun$avg_footfall)
mean(shrm_ff_hour_sun$avg_footfall)
mean(tb_ff_hour_sun$avg_footfall)
mean(wrs_ff_hour_sun$avg_footfall)

```

## Data wrangling for spatial autocorrelation -- whole day all hours

```{r}
# Joining footfall data with geospatial data for spatial autocorrelation
location <- location %>%
  filter(instsigid %in% c("100027", "100059", "100065", "100070", "100072", 
                          "100081", "100087", "100088", "100089", "100091", 
                          "100092", "100095", "100098")) %>%
  clean_names()

ff_hour_mon <- read_csv(here::here("ff_hour_mon.csv"))
ff_hour_mon <- ff_hour_mon %>%
  clean_names() %>%
  left_join(.,
            location,
            by = c("street" = "street"))

ff_hour_tue <- read_csv(here::here("ff_hour_tue.csv"))
ff_hour_tue <- ff_hour_tue %>%
  clean_names() %>%
  left_join(.,
            location,
            by = c("street" = "street"))

ff_hour_wed <- read_csv(here::here("ff_hour_wed.csv"))
ff_hour_wed <- ff_hour_wed %>%
  clean_names() %>%
  left_join(.,
            location,
            by = c("street" = "street"))

ff_hour_thur <- read_csv(here::here("ff_hour_thur.csv"))
ff_hour_thur <- ff_hour_thur %>%
  clean_names() %>%
  left_join(.,
            location,
            by = c("street" = "street"))

ff_hour_fri <- read_csv(here::here("ff_hour_fri.csv"))
ff_hour_fri <- ff_hour_fri %>%
  clean_names() %>%
  left_join(.,
            location,
            by = c("street" = "street"))

ff_hour_sat <- read_csv(here::here("ff_hour_sat.csv"))
ff_hour_sat <- ff_hour_sat %>%
  clean_names() %>%
  left_join(.,
            location,
            by = c("street" = "street"))

ff_hour_sun <- read_csv(here::here("ff_hour_sun.csv"))
ff_hour_sun <- ff_hour_sun %>%
  clean_names() %>%
  left_join(.,
            location,
            by = c("street" = "street"))

# Project them into the same coordination as boroughs, wards, and lsoas
ff_hour_mon_points <- ff_hour_mon %>%
  st_as_sf(., coords = c("longitude", "latitude"),
           crs = 4326)
ff_hour_tue_points <- ff_hour_tue %>%
  st_as_sf(., coords = c("longitude", "latitude"),
           crs = 4326)
ff_hour_wed_points <- ff_hour_wed %>%
  st_as_sf(., coords = c("longitude", "latitude"),
           crs = 4326)
ff_hour_thur_points <- ff_hour_thur %>%
  st_as_sf(., coords = c("longitude", "latitude"),
           crs = 4326)
ff_hour_fri_points <- ff_hour_fri %>%
  st_as_sf(., coords = c("longitude", "latitude"),
           crs = 4326)
ff_hour_sat_points <- ff_hour_sat %>%
  st_as_sf(., coords = c("longitude", "latitude"),
           crs = 4326)
ff_hour_sun_points <- ff_hour_sun %>%
  st_as_sf(., coords = c("longitude", "latitude"),
           crs = 4326)
```

```{r}
# To check the projection
ff_hour_mon_map <- tm_shape(boroughs) +
  tm_polygons(col = "white", alpha = 0.1) +
  tm_text("NAME", size = 0.3, col = "black", fontface = 2) +
tm_shape(ff_hour_mon_points) +
  tm_dots(col = "blue") +
  tm_layout(title = "Spatial Distribution of Retail Locations", title.position = c('center', 'top'), title.size = 0.8, inner.margins = c(0.1, 0.1, 0.1, 0.1), legend.position = c('right')) +
  tm_compass(position = c('right', 'top'))
ff_hour_mon_points


# Reprojecting them to British National Grid 27700
ff_hour_mon_points <- ff_hour_mon_points %>%
  st_transform(., 27700)
boroughs <- boroughs %>%
  st_transform(., 27700)
wards <- wards %>%
  st_transform(., 27700)
lsoas <- lsoas %>%
  st_transform(., 27700)
tmap_mode("plot")
tm_shape(wards) +
  tm_polygons(col = NA, alpha = 0.5) +
tm_shape(ff_hour_mon_points) +
  tm_dots(col = "blue")

# Reprojecting them to British National Grid 27700
ff_hour_tue_points <- ff_hour_tue_points %>%
  st_transform(., 27700)
tmap_mode("plot")
tm_shape(wards) +
  tm_polygons(col = NA, alpha = 0.5) +
tm_shape(ff_hour_tue_points) +
  tm_dots(col = "blue")

# Reprojecting them to British National Grid 27700
ff_hour_wed_points <- ff_hour_wed_points %>%
  st_transform(., 27700)
tmap_mode("plot")
tm_shape(wards) +
  tm_polygons(col = NA, alpha = 0.5) +
tm_shape(ff_hour_wed_points) +
  tm_dots(col = "blue")

# Reprojecting them to British National Grid 27700
ff_hour_thur_points <- ff_hour_thur_points %>%
  st_transform(., 27700)
tmap_mode("plot")
tm_shape(wards) +
  tm_polygons(col = NA, alpha = 0.5) +
tm_shape(ff_hour_thur_points) +
  tm_dots(col = "blue")

# Reprojecting them to British National Grid 27700
ff_hour_fri_points <- ff_hour_fri_points %>%
  st_transform(., 27700)
tmap_mode("plot")
tm_shape(wards) +
  tm_polygons(col = NA, alpha = 0.5) +
tm_shape(ff_hour_fri_points) +
  tm_dots(col = "blue")

# Reprojecting them to British National Grid 27700
ff_hour_sat_points <- ff_hour_sat_points %>%
  st_transform(., 27700)
tmap_mode("plot")
tm_shape(wards) +
  tm_polygons(col = NA, alpha = 0.5) +
tm_shape(ff_hour_sat_points) +
  tm_dots(col = "blue")

# Reprojecting them to British National Grid 27700
ff_hour_sun_points <- ff_hour_sun_points %>%
  st_transform(., 27700)
tmap_mode("plot")
tm_shape(wards) +
  tm_polygons(col = NA, alpha = 0.5) +
tm_shape(ff_hour_sun_points) +
  tm_dots(col = "blue")
```

### Point Pattern Analysis

```{r}
# Need? 
```

### Spatial autocorrelation

```{r}
# Simple Spatial Autocorrelation
library(RColorBrewer)
ff_hour_mon_sf_joined_wards <- wards %>%
  mutate(n = lengths(st_intersects(., ff_hour_mon_points))) %>%
  janitor::clean_names() %>%
  mutate(area = st_area(.)) %>%
  mutate(density = n/area)

tm_shape(ff_hour_mon_sf_joined_wards) +
  tm_polygons("density",
              style = "jenks",
              n = 10,
              palette = "YlOrBr",
              title = "Footfall density in mondays 2022")
```

```{r}
ff_hour_tue_sf_joined_wards <- wards %>%
  mutate(n = lengths(st_intersects(., ff_hour_tue_points))) %>%
  janitor::clean_names() %>%
  mutate(area = st_area(.)) %>%
  mutate(density = n/area)

tm_shape(ff_hour_tue_sf_joined_wards) +
  tm_polygons("density",
              style = "jenks",
              n = 10,
              palette = "YlOrBr",
              title = "Footfall density in tuesdays 2022")
```

```{r}
ff_hour_wed_sf_joined_wards <- wards %>%
  mutate(n = lengths(st_intersects(., ff_hour_wed_points))) %>%
  janitor::clean_names() %>%
  mutate(area = st_area(.)) %>%
  mutate(density = n/area)

tm_shape(ff_hour_wed_sf_joined_wards) +
  tm_polygons("density",
              style = "jenks",
              n = 10,
              palette = "YlOrBr",
              title = "Footfall density in wednesdays 2022")
```

```{r}
ff_hour_thur_sf_joined_wards <- wards %>%
  mutate(n = lengths(st_intersects(., ff_hour_thur_points))) %>%
  janitor::clean_names() %>%
  mutate(area = st_area(.)) %>%
  mutate(density = n/area)

tm_shape(ff_hour_thur_sf_joined_wards) +
  tm_polygons("density",
              style = "jenks",
              n = 10,
              palette = "YlOrBr",
              title = "Footfall density in thursdays 2022")
```

```{r}
ff_hour_fri_sf_joined_wards <- wards %>%
  mutate(n = lengths(st_intersects(., ff_hour_fri_points))) %>%
  janitor::clean_names() %>%
  mutate(area = st_area(.)) %>%
  mutate(density = n/area)

tm_shape(ff_hour_fri_sf_joined_wards) +
  tm_polygons("density",
              style = "jenks",
              n = 10,
              palette = "YlOrBr",
              title = "Footfall density in fridays 2022")
```

```{r}
ff_hour_sat_sf_joined_wards <- wards %>%
  mutate(n = lengths(st_intersects(., ff_hour_sat_points))) %>%
  janitor::clean_names() %>%
  mutate(area = st_area(.)) %>%
  mutate(density = n/area)

tm_shape(ff_hour_sat_sf_joined_wards) +
  tm_polygons("density",
              style = "jenks",
              n = 10,
              palette = "YlOrBr",
              title = "Footfall density in saturdays 2022")
```

```{r}
ff_hour_sun_sf_joined_wards <- wards %>%
  mutate(n = lengths(st_intersects(., ff_hour_sun_points))) %>%
  janitor::clean_names() %>%
  mutate(area = st_area(.)) %>%
  mutate(density = n/area)

tm_shape(ff_hour_sun_sf_joined_wards) +
  tm_polygons("density",
              style = "jenks",
              n = 10,
              palette = "YlOrBr",
              title = "Footfall density in sundays 2022")
```

#### Moran's I weighted matrix

```{r}
library(spdep)

# Mondays

coordsW_mon <- ff_hour_mon_sf_joined_wards %>%
  st_centroid() %>%
  st_geometry()
plot(coordsW_mon, axes = TRUE)

# Create a neighbour list
wards_nb_mon <- ff_hour_mon_sf_joined_wards %>%
  poly2nb(., queen = T)
summary(wards_nb_mon)

# Spatial weight matrix
wards_nb_mon.lw <- wards_nb_mon %>%
  nb2mat(., style = "W")
sum(wards_nb_mon.lw)

wards_nb_mon.lw <- wards_nb_mon %>%
  nb2listw(., style = "W")

plot(wards_nb_mon, st_geometry(coordsW_mon), col = "red")
# plot(ff_hour_mon_sf_joined_wards$geometry, add=T)

# Global Moran's I 
ff_hour_mon_moran_global <- ff_hour_mon_sf_joined_wards %>%
  pull(density) %>%
  as.vector() %>%
  moran.test(., wards_nb_mon.lw)
ff_hour_mon_moran_global

# Moran I Statistic: 0.01864225618
# Expectation: -0.0015432099
# Variance: 0.0004447862

# Local Moran's I
ff_hour_mon_moran_local <- ff_hour_mon_sf_joined_wards %>%
  pull(density) %>%
  as.vector() %>%
  localmoran(., wards_nb_mon.lw) %>%
  as_tibble()
ff_hour_mon_moran_local
```

```{r}
# Mapping
m_breaks<-c(-1000,-2.58,-1.96,-1.65,1.65,1.96,2.58,1000)
morancolors <- rev(brewer.pal(8, "RdGy")) 

ff_hour_mon_sf_joined_wards <- ff_hour_mon_sf_joined_wards %>%
  mutate(density_I =as.numeric(ff_hour_mon_moran_local$Ii))%>%
  mutate(density_Iz =as.numeric(ff_hour_mon_moran_local$Z.Ii))


tm_shape(ff_hour_mon_sf_joined_wards) +
    tm_polygons("density_Iz",
        style="fixed",
        breaks = m_breaks,
        palette = morancolors,
        midpoint=NA,
        title="Moran's I value") +
    tm_layout(title = "Monday")
```

```{r}

# Tuesday 

coordsW_tue <- ff_hour_tue_sf_joined_wards %>%
  st_centroid() %>%
  st_geometry()
plot(coordsW_tue, axes = TRUE)

# Create a neighbour list
wards_nb_tue <- ff_hour_tue_sf_joined_wards %>%
  poly2nb(., queen = T)
summary(wards_nb_tue)

# Spatial weight matrix
wards_nb_tue.lw <- wards_nb_tue %>%
  nb2mat(., style = "W")
sum(wards_nb_tue.lw)

wards_nb_tue.lw <- wards_nb_tue %>%
  nb2listw(., style = "W")

plot(wards_nb_tue, st_geometry(coordsW_mon), col = "red")
# plot(ff_hour_mon_sf_joined_wards$geometry, add=T)

# Global Moran's I 
ff_hour_tue_moran_global <- ff_hour_tue_sf_joined_wards %>%
  pull(density) %>%
  as.vector() %>%
  moran.test(., wards_nb_tue.lw)
ff_hour_tue_moran_global

# Moran I Statistic: 0.01864225618
# Expectation: -0.0015432099
# Variance: 0.0004447862

# Local Moran's I
ff_hour_tue_moran_local <- ff_hour_tue_sf_joined_wards %>%
  pull(density) %>%
  as.vector() %>%
  localmoran(., wards_nb_mon.lw) %>%
  as_tibble()
ff_hour_tue_moran_local
```

```{r}
ff_hour_tue_sf_joined_wards <- ff_hour_tue_sf_joined_wards %>%
  mutate(density_I =as.numeric(ff_hour_tue_moran_local$Ii))%>%
  mutate(density_Iz =as.numeric(ff_hour_tue_moran_local$Z.Ii))


tm_shape(ff_hour_tue_sf_joined_wards) +
    tm_polygons("density_Iz",
        style="fixed",
        breaks = m_breaks,
        palette = morancolors,
        midpoint=NA,
        title="Moran's I value")+
    tm_layout(title = "Tuesday")
```

```{r}
# Wednesday
coordsW_wed <- ff_hour_wed_sf_joined_wards %>%
  st_centroid() %>%
  st_geometry()
plot(coordsW_wed, axes = TRUE)

# Create a neighbour list
wards_nb_wed <- ff_hour_wed_sf_joined_wards %>%
  poly2nb(., queen = T)
summary(wards_nb_wed)

# Spatial weight matrix
wards_nb_wed.lw <- wards_nb_wed %>%
  nb2mat(., style = "W")
sum(wards_nb_wed.lw)

wards_nb_wed.lw <- wards_nb_wed %>%
  nb2listw(., style = "W")

plot(wards_nb_wed, st_geometry(coordsW_wed), col = "red")
# plot(ff_hour_mon_sf_joined_wards$geometry, add=T)

# Global Moran's I 
ff_hour_wed_moran_global <- ff_hour_wed_sf_joined_wards %>%
  pull(density) %>%
  as.vector() %>%
  moran.test(., wards_nb_wed.lw)
ff_hour_wed_moran_global

# Moran I Statistic: 0.01864225618
# Expectation: -0.0015432099
# Variance: 0.0004447862

# Local Moran's I
ff_hour_wed_moran_local <- ff_hour_wed_sf_joined_wards %>%
  pull(density) %>%
  as.vector() %>%
  localmoran(., wards_nb_wed.lw) %>%
  as_tibble()
ff_hour_wed_moran_local

ff_hour_wed_sf_joined_wards <- ff_hour_wed_sf_joined_wards %>%
  mutate(density_I =as.numeric(ff_hour_wed_moran_local$Ii))%>%
  mutate(density_Iz =as.numeric(ff_hour_wed_moran_local$Z.Ii))


tm_shape(ff_hour_wed_sf_joined_wards) +
    tm_polygons("density_Iz",
        style="fixed",
        breaks = m_breaks,
        palette = morancolors,
        midpoint=NA,
        title="Moran's I value")+
    tm_layout(title = "Wednesday")
```

```{r}
# Thursday
coordsW_thur <- ff_hour_thur_sf_joined_wards %>%
  st_centroid() %>%
  st_geometry()
plot(coordsW_thur, axes = TRUE)

# Create a neighbour list
wards_nb_thur <- ff_hour_thur_sf_joined_wards %>%
  poly2nb(., queen = T)
summary(wards_nb_thur)

# Spatial weight matrix
wards_nb_thur.lw <- wards_nb_thur %>%
  nb2mat(., style = "W")
sum(wards_nb_thur.lw)

wards_nb_thur.lw <- wards_nb_thur %>%
  nb2listw(., style = "W")

plot(wards_nb_thur, st_geometry(coordsW_thur), col = "red")
# plot(ff_hour_mon_sf_joined_wards$geometry, add=T)

# Global Moran's I 
ff_hour_thur_moran_global <- ff_hour_thur_sf_joined_wards %>%
  pull(density) %>%
  as.vector() %>%
  moran.test(., wards_nb_thur.lw)
ff_hour_thur_moran_global

# Moran I Statistic: 0.01864225618
# Expectation: -0.0015432099
# Variance: 0.0004447862

# Local Moran's I
ff_hour_thur_moran_local <- ff_hour_thur_sf_joined_wards %>%
  pull(density) %>%
  as.vector() %>%
  localmoran(., wards_nb_thur.lw) %>%
  as_tibble()
ff_hour_thur_moran_local

ff_hour_thur_sf_joined_wards <- ff_hour_thur_sf_joined_wards %>%
  mutate(density_I =as.numeric(ff_hour_thur_moran_local$Ii))%>%
  mutate(density_Iz =as.numeric(ff_hour_thur_moran_local$Z.Ii))


tm_shape(ff_hour_thur_sf_joined_wards) +
    tm_polygons("density_Iz",
        style="fixed",
        breaks = m_breaks,
        palette = morancolors,
        midpoint=NA,
        title="Moran's I value")+
    tm_layout(title = "Thursday")
```

```{r}
# Friday
coordsW_fri <- ff_hour_fri_sf_joined_wards %>%
  st_centroid() %>%
  st_geometry()
plot(coordsW_fri, axes = TRUE)

# Create a neighbour list
wards_nb_fri <- ff_hour_fri_sf_joined_wards %>%
  poly2nb(., queen = T)
summary(wards_nb_fri)

# Spatial weight matrix
wards_nb_fri.lw <- wards_nb_fri %>%
  nb2mat(., style = "W")
sum(wards_nb_fri.lw)

wards_nb_fri.lw <- wards_nb_fri %>%
  nb2listw(., style = "W")

plot(wards_nb_fri, st_geometry(coordsW_fri), col = "red")
# plot(ff_hour_mon_sf_joined_wards$geometry, add=T)

# Global Moran's I 
ff_hour_fri_moran_global <- ff_hour_fri_sf_joined_wards %>%
  pull(density) %>%
  as.vector() %>%
  moran.test(., wards_nb_fri.lw)
ff_hour_fri_moran_global

# Moran I Statistic: 0.01864225618
# Expectation: -0.0015432099
# Variance: 0.0004447862

# Local Moran's I
ff_hour_fri_moran_local <- ff_hour_fri_sf_joined_wards %>%
  pull(density) %>%
  as.vector() %>%
  localmoran(., wards_nb_fri.lw) %>%
  as_tibble()
ff_hour_fri_moran_local

ff_hour_fri_sf_joined_wards <- ff_hour_fri_sf_joined_wards %>%
  mutate(density_I =as.numeric(ff_hour_fri_moran_local$Ii))%>%
  mutate(density_Iz =as.numeric(ff_hour_fri_moran_local$Z.Ii))


tm_shape(ff_hour_fri_sf_joined_wards) +
    tm_polygons("density_Iz",
        style="fixed",
        breaks = m_breaks,
        palette = morancolors,
        midpoint=NA,
        title="Moran's I value")+
    tm_layout(title = "Friday")
```

```{r}
# Saturday
coordsW_sat <- ff_hour_sat_sf_joined_wards %>%
  st_centroid() %>%
  st_geometry()
plot(coordsW_sat, axes = TRUE)

# Create a neighbour list
wards_nb_sat <- ff_hour_sat_sf_joined_wards %>%
  poly2nb(., queen = T)
summary(wards_nb_sat)

# Spatial weight matrix
wards_nb_sat.lw <- wards_nb_sat %>%
  nb2mat(., style = "W")
sum(wards_nb_sat.lw)

wards_nb_sat.lw <- wards_nb_sat %>%
  nb2listw(., style = "W")

plot(wards_nb_sat, st_geometry(coordsW_sat), col = "red")
# plot(ff_hour_mon_sf_joined_wards$geometry, add=T)

# Global Moran's I 
ff_hour_sat_moran_global <- ff_hour_sat_sf_joined_wards %>%
  pull(density) %>%
  as.vector() %>%
  moran.test(., wards_nb_sat.lw)
ff_hour_sat_moran_global

# Moran I Statistic: 0.01864225618
# Expectation: -0.0015432099
# Variance: 0.0004447862

# Local Moran's I
ff_hour_sat_moran_local <- ff_hour_sat_sf_joined_wards %>%
  pull(density) %>%
  as.vector() %>%
  localmoran(., wards_nb_fri.lw) %>%
  as_tibble()
ff_hour_sat_moran_local

ff_hour_sat_sf_joined_wards <- ff_hour_sat_sf_joined_wards %>%
  mutate(density_I =as.numeric(ff_hour_sat_moran_local$Ii))%>%
  mutate(density_Iz =as.numeric(ff_hour_sat_moran_local$Z.Ii))

tm_shape(ff_hour_sat_sf_joined_wards) +
    tm_polygons("density_Iz",
        style="fixed",
        breaks = m_breaks,
        palette = morancolors,
        midpoint=NA,
        title="Moran's I value")+
    tm_layout(title = "Saturday")
```



```{r}
# Sunday
coordsW_sun <- ff_hour_sun_sf_joined_wards %>%
  st_centroid() %>%
  st_geometry()
plot(coordsW_sun, axes = TRUE)

# Create a neighbour list
wards_nb_sun <- ff_hour_sun_sf_joined_wards %>%
  poly2nb(., queen = T)
summary(wards_nb_sun)

# Spatial weight matrix
wards_nb_sun.lw <- wards_nb_sun %>%
  nb2mat(., style = "W")
sum(wards_nb_sun.lw)

wards_nb_sun.lw <- wards_nb_sun %>%
  nb2listw(., style = "W")

plot(wards_nb_sun, st_geometry(coordsW_sun), col = "red")
# plot(ff_hour_mon_sf_joined_wards$geometry, add=T)

# Global Moran's I 
ff_hour_sun_moran_global <- ff_hour_sun_sf_joined_wards %>%
  pull(density) %>%
  as.vector() %>%
  moran.test(., wards_nb_sun.lw)
ff_hour_sun_moran_global

# Moran I Statistic: 0.01864225618
# Expectation: -0.0015432099
# Variance: 0.0004447862

# Local Moran's I
ff_hour_sun_moran_local <- ff_hour_sun_sf_joined_wards %>%
  pull(density) %>%
  as.vector() %>%
  localmoran(., wards_nb_fri.lw) %>%
  as_tibble()
ff_hour_sun_moran_local

ff_hour_sun_sf_joined_wards <- ff_hour_sun_sf_joined_wards %>%
  mutate(density_I =as.numeric(ff_hour_sun_moran_local$Ii))%>%
  mutate(density_Iz =as.numeric(ff_hour_sun_moran_local$Z.Ii))


tm_shape(ff_hour_sun_sf_joined_wards) +
    tm_polygons("density_Iz",
        style="fixed",
        breaks = m_breaks,
        palette = morancolors,
        midpoint=NA,
        title="Moran's I value")+
    tm_layout(title = "Sunday")
```

